#include <stdint.h>
#include <stdlib.h>
#include "params.h"
#include "poly.h"
#include "reduce.h"
#include "rounding.h"
#include "symmetric.h"
#include <string.h>
#include <time.h>
#include "packing.h"
#include "./sign.h"
#include <stdio.h>


#ifdef DBENCH
#include "test/cpucycles.h"
extern const uint64_t timing_overhead;
extern uint64_t *tred, *tadd, *tmul, *tround, *tsample, *tpack;
#define DBENCH_START() uint64_t time = cpucycles()
#define DBENCH_STOP(t) t += cpucycles() - time - timing_overhead
#else
#define DBENCH_START()
#define DBENCH_STOP(t)
#endif

#if NIMS_TRI_NTT_MODE == 1
//N = 1152 = 2^7 * 3^2
//Q = 8401537
//zeta = 174396 //(2^7*3^3)th root of unity
//invMONT = 4009235
//invzeta = 6214534 
//W = zeta^(2^7 * 3^2) = 4804004
#define MONT 1781889 // 2^32 % Q

#define Wmont	1857311 //mont * W (W : 3rd root of unity)
#define W2mont	4762337 //mont * W^2
#define	F1	5143946 //mont^2/N
#define F2	1886355 //2 * mont^2/N

#define radix3_len 3 //radix-3 2번
#define radix2_redlen_ntt (N>>8)
#define radix2_redlen_invntt (N>>3)


int32_t merging_zetas[]= {3639200, 2686861, 6424568, 6554301, 7526435, 877607, 306698, 4659475, 3390155, 4282716, 2808328, 2116573, 5543577, 1552595, 3460077, 432998, 1424358, 6433532, 184706, 2775436, 5190529, 8309856, 5524170, 907034, 1179760, 1878681, 8184262, 2536834, 6481742, 4693847, 4814234, 180498, 3132507, 7290507, 4004427, 1957344, 6032763, 2486172, 1485307, 3001095, 1251, 347708, 7922675, 2440877, 7044727, 4274417, 3564940, 2831444, 1643646, 6469915, 8315960, 1758450, 7099282, 4932998, 3590231, 2162462, 4706816, 3277849, 1524716, 4050420, 7601909, 7594467, 5145204, 7823061, 3264673, 959142, 33147, 8348313, 5706219, 5641511, 5056889, 7716605, 2768240, 3125966, 662643, 6249357, 4070954, 7628050, 4602216, 5394914, 35121, 74136, 1732710, 2427534, 7254923, 1054835, 128776, 6297943, 8089830, 418975, 6436867, 1595450, 5925628, 6136950, 7283296, 6663782, 1962506, 5691488, 5391729, 5785737, 5642710, 5281972, 2650439, 6112046, 821034, 6317452, 88822, 4418807, 4770462, 6502665, 2888434, 3205705, 4068162, 1652755, 966215, 3845994, 7352241, 989379, 801959, 6977760, 3823033, 8233299, 4378563, 814504, 7392628, 3440373, 1721};
int32_t merging_zetas_radix3[] = {166697, 6845588, 6665025, 1055950, 5397364, 7983055, 8357888, 3421184, 3919256, 3438345, 4410150, 4092812, 1416683, 7195496, 5728828, 6185265, 3723422, 1882396, 7779633, 2216272, 869976, 7513996, 5677537, 7345587, 3547575, 1555949, 7289392, 8251446, 7040902, 5766783, 7670156, 4308725, 6400991, 3281506, 6768989, 6272686, 5312884, 1804128, 4912184, 5236045, 2809088, 1173945, 1525494, 5379350, 7224001, 5838419, 8032750, 4157775, 1253810, 4455451, 6366809, 4243762, 1463651, 2213858, 1286086, 2128851, 3989177, 5120031, 1998401, 3709568, 350843, 5961903, 5982363, 3022187, 2762523, 2497947, 1729880, 1444848, 2867333, 2520659, 8114824, 8176527, 5640971, 5241189, 5619998, 7414630, 5451998, 8157324, 891074, 3019018, 259380, 7739136, 2884256, 5382519, 1623184, 7189620, 1780643, 6956689, 5659819, 5903590, 2037329, 1200635, 5795677, 5539677, 6705351, 986907, 8164013, 4626509, 5544997, 7293981, 7269149, 822304, 1272183, 6331963, 5067109, 5700756, 8248400, 7784199, 2850064, 6730950, 5995097, 7818575, 4870071, 1925728, 6785547, 582962, 1610847, 5714625, 1972010, 1107556, 1335085, 3775028, 3988549, 5623394, 6186475, 239342, 4137664, 617338, 6000207, 3986235, 6427198, 1761884, 7442507, 4347876, 146701, 4587787, 6301921, 5153193, 2338904, 325165, 4336178, 2939034, 7937225, 1332138, 2235158, 737891, 1822626, 7069399, 544749, 4912952, 1389189, 6639653, 8223422, 4415302, 7387824, 4700918, 7389544, 5680014, 7364226, 8076372, 3844299, 2372245, 5700908, 2689186, 3381791, 7807571, 1186891, 6253391, 8227131, 1203793, 8398078, 3810723, 3050069, 1689658, 4760685, 7372983, 7548598, 3576038, 7110541, 1028554, 7749009, 1662577, 461062, 5712351, 7192649, 6029292, 3916284, 4378844, 4563661, 6779017, 104652, 4590814, 7355171, 4185321, 4911153, 8388112, 2257957, 4238909, 750546, 5876447, 1311251, 924531, 2837347, 2591074, 7364365, 4845849, 3895548, 6395666, 2222840, 5109852, 1272944, 2005871, 97634, 65984, 301773, 13425, 4514923, 4216216, 116406, 4832424, 2604530, 2233038, 1618071, 5810463, 8025058, 6796594, 3682449, 7366625, 336813, 2140402, 2378882, 6161882, 273132, 5125424, 6856111, 3080743, 259546, 5753620, 7726772, 1461437, 7441504, 3520481, 694493, 6940100, 5320068, 841088, 7229206, 1034912, 3600911, 1604943, 4902281, 4718708, 5084858, 3601839, 6490674, 5320794, 6786372, 5073513, 1560222, 3366627, 6673736, 1387431, 5435217, 1456875, 3965136, 7052183, 4973489, 6802716, 676078, 3189565, 1048441, 7520903, 130820, 3724159, 7208192, 880634, 3156148, 8259591, 5084688, 5034910, 8163426, 3328024, 2426084, 6556192, 3834447, 506797, 6168821, 1598821, 4794542, 3390860, 7425926, 3334575, 3057769, 2283912, 348882, 1539320, 5221396, 6921825, 494139, 5867745, 7702617, 221956, 4621787, 2350794, 4607652, 1911148, 3870025, 6050743, 4531429, 7407065, 5033868, 5066962, 6576914, 5010677, 1645681, 3556531, 1048954, 4634706, 3492407, 2533792, 514029, 3935336, 4090292, 2867599, 6066303, 375767, 3522876, 4806010, 1328031, 4486445, 2911167, 8130447, 8036213, 7256718, 4127023, 6726637, 3824161, 20244, 4931633, 1674900, 1565727, 4534920, 1659243, 5533938, 471459, 4466201, 7030537, 1722780, 2986958, 7102404, 7086664, 271090, 5324318, 5560875, 6661532, 8251647, 1433627, 4659462, 6534493, 2206251, 7777014, 6127693, 7579864, 545577, 7298144, 6773636, 8123459, 1882877, 7613357, 3287031, 8069214, 6518660, 1169641, 2751828, 631538, 149890, 837334, 2840662, 1554066, 6623746, 3911736, 6542339, 4865068, 7855960, 913651, 4403202, 5971606, 7552197, 1214256, 4675293, 5494430, 4274332, 2603493, 5034447, 4724383, 7031319, 5691014, 7292838, 3937736, 3357277, 126705, 1036112, 334192, 5044260, 1372155, 2904114, 3492578, 849340, 97875, 3998335, 6397371, 6443498, 1932093, 8032570, 1952112, 1370218, 433968, 1504803, 5732876, 2529673, 332153, 776340, 5769014, 5623332, 1846049, 2324173, 2209806, 5465102, 5787086, 4789376, 2758040, 5774153, 2922670, 3828976, 7029097, 2627384, 7892769, 2686897, 4988024, 5871864, 7083542, 6896734, 6915676, 7319049, 6758531, 6550493, 718978, 2936435, 7639038, 5784777, 905530, 7690598, 6502344, 8009749, 4402068, 317038, 4320431, 252265, 6911650, 3694781, 6016716, 5415336, 452555, 3207273, 1995241, 6037042, 7753405, 5194264, 7352045, 4011819, 7593818, 710939, 2207645, 2616760, 1837278, 4704397, 5448151, 2815485, 5939777, 4706756, 1674074, 2786635, 5300999, 243836, 4940590, 1565819, 7871804, 56413, 6194638, 5032277, 5492095, 44944, 877240, 4823119, 8188766, 2207844, 8028620, 7818912, 2102600, 6193693, 311750, 101357, 8013418, 8157701, 6609610, 5614902, 5728214, 5066955, 1827084, 3773663, 7376204, 8356593, 1672121, 5236652, 7402811, 3550421, 6279939, 5065101, 1667742, 1071664, 88165, 6884768, 868824, 6227003, 6241571, 7572800, 5983894, 7163505, 730565, 3719883, 2613809, 1238032, 2194640, 7298667, 1106173, 4851116, 5051056, 3164885, 5052715, 2721684, 7540196, 3827069, 6358048, 2174534, 5366704, 6982292, 2000622, 2002206, 386535, 5459951, 3151447, 7084159, 2280675, 7058482, 5680212, 5912141, 1029201, 5179930, 8364935, 2725193, 6838596, 5639237, 6237576, 5676344, 5212315, 4594763, 110922, 6399331, 1624362, 1419245, 6154074, 7182136, 4350830, 8185144, 4439090, 2489396, 4965202, 8038247, 6732205, 1930591, 6753105, 4241250, 779309, 6020930, 1128088, 4667850, 5349334, 6917451, 6231802, 972083, 3167615, 2910987, 3278486, 4304560, 6712821, 5490550, 4224895, 4536844, 8002439, 6470946, 5814750, 363290, 4038844, 2902674, 8034990, 7152237, 422949, 1484086, 7433838, 6240075, 5775104, 8368151, 7486873, 5486853, 99336, 5216654, 35252, 5924414, 5161793, 3598049, 5797824, 7265323, 3830902, 7598667, 4768038, 3762952, 8170391, 802870, 2405954, 413166, 125372, 33386, 5166111, 2161462, 1794968, 7231937, 4605560, 4683983, 2154908, 4803488, 5215641, 4042892, 4949988, 3365037, 7792083, 1870695, 2738253, 31351, 2836346, 1013632, 2169683, 3993044, 6367918, 1820338, 6361249, 4589212, 7643252, 5056524, 521183, 3812325, 1521152, 4024395, 1094223, 5036500, 693331, 4358645, 5198194, 5185375, 6893471, 6459907, 6938845, 4408493, 4663564, 5484672, 7186745, 2752032, 7486996, 6048222, 3233448, 7000252, 2565047, 6782582, 3815064, 6617490, 387443, 4892947, 6615927, 355439, 4698106, 3865717, 1253114, 8046098, 3417988, 5216205, 2207387, 5649505, 3748470, 2916865, 6402334, 7644979, 4213423, 6403661, 316844, 1784047, 1084779, 6228893, 4142843, 3392613, 3309611, 51966, 295518, 120838, 3574146, 6979264, 5265114, 6244362, 5517655, 1599226, 8316386, 1601446, 5502127, 4806620, 2896051, 6800091, 326103, 6365200, 2634223, 5008924, 2032195, 2172644, 5678895, 4991839, 667587, 1653412, 7845810, 2157175, 1082847, 2591025, 5383208, 8131423, 2978262, 4011609, 258976, 6005912, 5934871, 5723287, 3063667, 1064785, 2274526, 5456268, 3271346, 4050356, 7768152, 8314312, 1675551, 4351181, 1097736, 7070697, 4083424, 270114, 8349902, 5810512, 5519289, 5186154, 2411258, 8061965, 2079298, 7336752, 5525650, 6692897, 2746890, 15659, 6947179, 883906, 4155353, 892614, 5969160, 5057514, 5130846, 5562656, 5970049, 6937875, 270021, 8333695, 2349929, 3348874, 438319, 67842, 318122, 6455270, 5418701, 8385878, 1012578, 1708640, 3788125, 6953534, 1047748, 816064, 3295236, 2838881, 2857261, 2377575, 4154298, 7052845, 7488303, 3191435, 2520594, 8379212, 7805834, 7061874, 6785910, 3791820, 5327580, 745503, 1100786, 4089772, 7920304, 1037912, 8281822, 4311765, 8161022, 3769495, 560710, 1348692, 5198125, 6023962, 5702415, 7798348, 7355223, 7281207, 2916424, 4609717, 146560, 4014599, 1633202, 525574, 1105642, 2359345, 1641973, 1787803, 967589, 1394046, 7001742, 7874901, 821968, 4494445, 7595588, 7690642, 5559678, 5408645, 5571547, 710895, 3459109, 1261167, 6359710, 7875963, 7945891, 4386938, 7801679, 5020019, 5449617, 1648450, 466968, 526636, 5427915, 4293417, 5098134, 2779781, 1332486, 2147861, 5805650, 2563232, 6435730, 3940482, 6517875, 572186, 6293378, 4012364, 3941538, 1971968, 2809349, 8233899, 616815, 6429569, 3474086, 3135418, 4175637, 5621756, 6825926, 4108120, 1739836, 6792145, 2251860, 4119829, 7688522, 7829351, 7566859, 1313441, 367439, 241443, 4682997, 3212560, 6671437, 3226644, 4278600, 3090802, 2009336, 5052706, 7467958, 2144163, 915068, 6508849, 6155990, 4404243, 2939820, 1892688, 1664987, 8279350, 5278158, 8160094, 4901487, 7088096, 204366, 2385606, 1895933, 1319872, 6587455, 3348831, 485894, 5729593, 5636171, 6679460, 2390628, 7457950, 3457582, 6879627, 4574612, 6595564, 4164448, 2107577, 5873513, 2664537, 7044546, 3156780, 6978853, 3923620, 5600839, 5244757, 1894707, 585667, 4241348, 1722077, 2087784, 2671944, 5184230, 942460, 7020864, 2213193, 7124957, 6293960, 5369630, 3926154, 6591521, 201694, 1711942, 3626816, 1118915, 5782088, 3027904, 2190967, 6032329, 7171571, 4433273, 6323640, 5775317, 5117609, 6389872, 6117121, 6402647, 3283928, 2557816, 4552122, 3106767, 8199843, 4049739, 4475383, 6111656, 6525334, 1985829, 342888, 496823, 1229966, 1099759, 3345374, 5792942, 2848026, 6892148, 3122682, 891628, 2930021, 3104, 7571714, 4736346, 7138788, 3961614, 86993, 2235645, 4026841, 230125, 2515551, 2277930, 4374696, 2713240, 1667272, 4023269, 5553511, 5404480, 5056163, 2711720, 2935019, 333336, 7149523, 5175216, 1262749};

int32_t merging_zetas_inv[] = {8399816, 4961164, 1008909, 7587033, 4022974, 168238, 4578504, 1423777, 7599578, 7412158, 1049296, 4555543, 7435322, 6748782, 4333375, 5195832, 5513103, 1898872, 3631075, 3982730, 8312715, 2084085, 7580503, 2289491, 5751098, 3119565, 2758827, 2615800, 3009808, 2710049, 6439031, 1737755, 1118241, 2264587, 2475909, 6806087, 1964670, 7982562, 311707, 2103594, 8272761, 7346702, 1146614, 5974003, 6668827, 8327401, 8366416, 3006623, 3799321, 773487, 4330583, 2152180, 7738894, 5275571, 5633297, 684932, 3344648, 2760026, 2695318, 53224, 8368390, 7442395, 5136864, 578476, 3256333, 807070, 799628, 4351117, 6876821, 5123688, 3694721, 6239075, 4811306, 3468539, 1302255, 6643087, 85577, 1931622, 6757891, 5570093, 4836597, 4127120, 1356810, 5960660, 478862, 8053829, 8400286, 5400442, 6916230, 5915365, 2368774, 6444193, 4397110, 1111030, 5269030, 8221039, 3587303, 3707690, 1919795, 5864703, 217275, 6522856, 7221777, 7494503, 2877367, 91681, 3211008, 5626101, 8216831, 1968005, 6977179, 7968539, 4941460, 6848942, 2857960, 6284964, 5593209, 4118821, 5011382, 3742062, 8094839,7523930,875102,1847236,1976969,5714676 ,968342};
int32_t merging_zetas_inv_radix3[] = {5175216, 1262749, 333336, 7149523, 2711720, 2935019, 5404480, 5056163, 4023269, 5553511, 2713240, 1667272, 2277930, 4374696, 230125, 2515551, 2235645, 4026841, 3961614, 86993, 4736346, 7138788, 3104, 7571714, 891628, 2930021, 6892148, 3122682, 5792942, 2848026, 1099759, 3345374, 496823, 1229966, 1985829, 342888, 6111656, 6525334, 4049739, 4475383, 3106767, 8199843, 2557816, 4552122, 6402647, 3283928, 6389872, 6117121, 5775317, 5117609, 4433273, 6323640, 6032329, 7171571, 3027904, 2190967, 1118915, 5782088, 1711942, 3626816, 6591521, 201694, 5369630, 3926154, 7124957, 6293960, 7020864, 2213193, 5184230, 942460, 2087784, 2671944, 4241348, 1722077, 1894707, 585667, 5600839, 5244757, 6978853, 3923620, 7044546, 3156780, 5873513, 2664537, 4164448, 2107577, 4574612, 6595564, 3457582, 6879627, 2390628, 7457950, 5636171, 6679460, 485894, 5729593, 6587455, 3348831, 1895933, 1319872, 204366, 2385606, 4901487, 7088096, 5278158, 8160094, 1664987, 8279350, 2939820, 1892688, 6155990, 4404243, 915068, 6508849, 7467958, 2144163, 2009336, 5052706, 4278600, 3090802, 6671437, 3226644, 4682997, 3212560, 367439, 241443, 7566859, 1313441, 7688522, 7829351, 2251860, 4119829, 1739836, 6792145, 6825926, 4108120, 4175637, 5621756, 3474086, 3135418, 616815, 6429569, 2809349, 8233899, 3941538, 1971968, 6293378, 4012364, 6517875, 572186, 6435730, 3940482, 5805650, 2563232, 1332486, 2147861, 5098134, 2779781, 5427915, 4293417, 466968, 526636, 5449617, 1648450, 7801679, 5020019, 7945891, 4386938, 6359710, 7875963, 3459109, 1261167, 5571547, 710895, 5559678, 5408645, 7595588, 7690642, 821968, 4494445, 7001742, 7874901, 967589, 1394046, 1641973, 1787803, 1105642, 2359345, 1633202, 525574, 146560, 4014599, 2916424, 4609717, 7355223, 7281207, 5702415, 7798348, 5198125, 6023962, 560710, 1348692, 8161022, 3769495, 8281822, 4311765, 7920304, 1037912, 1100786, 4089772, 5327580, 745503, 6785910, 3791820, 7805834, 7061874, 2520594, 8379212, 7488303, 3191435, 4154298, 7052845, 2857261, 2377575, 3295236, 2838881, 1047748, 816064, 3788125, 6953534, 1012578, 1708640, 5418701, 8385878, 318122, 6455270, 438319, 67842, 2349929, 3348874, 270021, 8333695, 5970049, 6937875, 5130846, 5562656, 5969160, 5057514, 4155353, 892614, 6947179, 883906, 2746890, 15659, 5525650, 6692897, 2079298, 7336752, 2411258, 8061965, 5519289, 5186154, 8349902, 5810512, 4083424, 270114, 1097736, 7070697, 1675551, 4351181, 7768152, 8314312, 3271346, 4050356, 2274526, 5456268, 3063667, 1064785, 5934871, 5723287, 258976, 6005912, 2978262, 4011609, 5383208, 8131423, 1082847, 2591025, 7845810, 2157175, 667587, 1653412, 5678895, 4991839, 2032195, 2172644, 2634223, 5008924, 326103, 6365200, 2896051, 6800091, 5502127, 4806620, 8316386, 1601446, 5517655, 1599226, 5265114, 6244362, 3574146, 6979264, 295518, 120838, 3309611, 51966, 4142843, 3392613, 1084779, 6228893, 316844, 1784047, 4213423, 6403661, 6402334, 7644979, 3748470, 2916865, 2207387, 5649505, 3417988, 5216205, 1253114, 8046098, 4698106, 3865717, 6615927, 355439, 387443, 4892947, 3815064, 6617490, 2565047, 6782582, 3233448, 7000252, 7486996, 6048222, 7186745, 2752032, 4663564, 5484672, 6938845, 4408493, 6893471, 6459907, 5198194, 5185375, 693331, 4358645, 1094223, 5036500, 1521152, 4024395, 521183, 3812325, 7643252, 5056524, 6361249, 4589212, 6367918, 1820338, 2169683, 3993044, 2836346, 1013632, 2738253, 31351, 7792083, 1870695, 4949988, 3365037, 5215641, 4042892, 2154908, 4803488, 4605560, 4683983, 1794968, 7231937, 5166111, 2161462, 125372, 33386, 2405954, 413166, 8170391, 802870, 4768038, 3762952, 3830902, 7598667, 5797824, 7265323, 5161793, 3598049, 35252, 5924414, 99336, 5216654, 7486873, 5486853, 5775104, 8368151, 7433838, 6240075, 422949, 1484086, 8034990, 7152237, 4038844, 2902674, 5814750, 363290, 8002439, 6470946, 4224895, 4536844, 6712821, 5490550, 3278486, 4304560, 3167615, 2910987, 6231802, 972083, 5349334, 6917451, 1128088, 4667850, 779309, 6020930, 6753105, 4241250, 6732205, 1930591, 4965202, 8038247, 4439090, 2489396, 4350830, 8185144, 6154074, 7182136, 1624362, 1419245, 110922, 6399331, 5212315, 4594763, 6237576, 5676344, 6838596, 5639237, 8364935, 2725193, 1029201, 5179930, 5680212, 5912141, 2280675, 7058482, 3151447, 7084159, 386535, 5459951, 2000622, 2002206, 5366704, 6982292, 6358048, 2174534, 7540196, 3827069, 5052715, 2721684, 5051056, 3164885, 1106173, 4851116, 2194640, 7298667, 2613809, 1238032, 730565, 3719883, 5983894, 7163505, 6241571, 7572800, 868824, 6227003, 88165, 6884768, 1667742, 1071664, 6279939, 5065101, 7402811, 3550421, 1672121, 5236652, 7376204, 8356593, 1827084, 3773663, 5728214, 5066955, 6609610, 5614902, 8013418, 8157701, 311750, 101357, 2102600, 6193693, 8028620, 7818912, 8188766, 2207844, 877240, 4823119, 5492095, 44944, 6194638, 5032277, 7871804, 56413, 4940590, 1565819, 5300999, 243836, 1674074, 2786635, 5939777, 4706756, 5448151, 2815485, 1837278, 4704397, 2207645, 2616760, 7593818, 710939, 7352045, 4011819, 7753405, 5194264, 1995241, 6037042, 452555, 3207273, 6016716, 5415336, 6911650, 3694781, 4320431, 252265, 4402068, 317038, 6502344, 8009749, 905530, 7690598, 7639038, 5784777, 718978, 2936435, 6758531, 6550493, 6915676, 7319049, 7083542, 6896734, 4988024, 5871864, 7892769, 2686897, 7029097, 2627384, 2922670, 3828976, 2758040, 5774153, 5787086, 4789376, 2209806, 5465102, 1846049, 2324173, 5769014, 5623332, 332153, 776340, 5732876, 2529673, 433968, 1504803, 1952112, 1370218, 1932093, 8032570, 6397371, 6443498, 97875, 3998335, 3492578, 849340, 1372155, 2904114, 334192, 5044260, 126705, 1036112, 3937736, 3357277, 5691014, 7292838, 4724383, 7031319, 2603493, 5034447, 5494430, 4274332, 1214256, 4675293, 5971606, 7552197, 913651, 4403202, 4865068, 7855960, 3911736, 6542339, 1554066, 6623746, 837334, 2840662, 631538, 149890, 1169641, 2751828, 8069214, 6518660, 7613357, 3287031, 8123459, 1882877, 7298144, 6773636, 7579864, 545577, 7777014, 6127693, 6534493, 2206251, 1433627, 4659462, 6661532, 8251647, 5324318, 5560875, 7086664, 271090, 2986958, 7102404, 7030537, 1722780, 471459, 4466201, 1659243, 5533938, 1565727, 4534920, 4931633, 1674900, 3824161, 20244, 4127023, 6726637, 8036213, 7256718, 2911167, 8130447, 1328031, 4486445, 3522876, 4806010, 6066303, 375767, 4090292, 2867599, 514029, 3935336, 3492407, 2533792, 1048954, 4634706, 1645681, 3556531, 6576914, 5010677, 5033868, 5066962, 4531429, 7407065, 3870025, 6050743, 4607652, 1911148, 4621787, 2350794, 7702617, 221956, 494139, 5867745, 5221396, 6921825, 348882, 1539320, 3057769, 2283912, 7425926, 3334575, 4794542, 3390860, 6168821, 1598821, 3834447, 506797, 2426084, 6556192, 8163426, 3328024, 5084688, 5034910, 3156148, 8259591, 7208192, 880634, 130820, 3724159, 1048441, 7520903, 676078, 3189565, 4973489, 6802716, 3965136, 7052183, 5435217, 1456875, 6673736, 1387431, 1560222, 3366627, 6786372, 5073513, 6490674, 5320794, 5084858, 3601839, 4902281, 4718708, 3600911, 1604943, 7229206, 1034912, 5320068, 841088, 694493, 6940100, 7441504, 3520481, 7726772, 1461437, 259546, 5753620, 6856111, 3080743, 273132, 5125424, 2378882, 6161882, 336813, 2140402, 3682449, 7366625, 8025058, 6796594, 1618071, 5810463, 2604530, 2233038, 116406, 4832424, 4514923, 4216216, 301773, 13425, 97634, 65984, 1272944, 2005871, 2222840, 5109852, 3895548, 6395666, 7364365, 4845849, 2837347, 2591074, 1311251, 924531, 750546, 5876447, 2257957, 4238909, 4911153, 8388112, 7355171, 4185321, 104652, 4590814, 4563661, 6779017, 3916284, 4378844, 7192649, 6029292, 461062, 5712351, 7749009, 1662577, 7110541, 1028554, 7548598, 3576038, 4760685, 7372983, 3050069, 1689658, 8398078, 3810723, 8227131, 1203793, 1186891, 6253391, 3381791, 7807571, 5700908, 2689186, 3844299, 2372245, 7364226, 8076372, 7389544, 5680014, 7387824, 4700918, 8223422, 4415302, 1389189, 6639653, 544749, 4912952, 1822626, 7069399, 2235158, 737891, 7937225, 1332138, 4336178, 2939034, 2338904, 325165, 6301921, 5153193, 146701, 4587787, 7442507, 4347876, 6427198, 1761884, 6000207, 3986235, 4137664, 617338, 6186475, 239342, 3988549, 5623394, 1335085, 3775028, 1972010, 1107556, 1610847, 5714625, 6785547, 582962, 4870071, 1925728, 5995097, 7818575, 2850064, 6730950, 8248400, 7784199, 5067109, 5700756, 1272183, 6331963, 7269149, 822304, 5544997, 7293981, 8164013, 4626509, 6705351, 986907, 5795677, 5539677, 2037329, 1200635, 5659819, 5903590, 1780643, 6956689, 1623184, 7189620, 2884256, 5382519, 259380, 7739136, 891074, 3019018, 5451998, 8157324, 5619998, 7414630, 5640971, 5241189, 8114824, 8176527, 2867333, 2520659, 1729880, 1444848, 2762523, 2497947, 5982363, 3022187, 350843, 5961903, 1998401, 3709568, 3989177, 5120031, 1286086, 2128851, 1463651, 2213858, 6366809, 4243762, 1253810, 4455451, 8032750, 4157775, 7224001, 5838419, 1525494, 5379350, 2809088, 1173945, 4912184, 5236045, 5312884, 1804128, 6768989, 6272686, 6400991, 3281506, 7670156, 4308725, 7040902, 5766783, 7289392, 8251446, 3547575, 1555949, 5677537, 7345587, 869976, 7513996, 7779633, 2216272, 3723422, 1882396, 5728828, 6185265, 1416683, 7195496, 4410150, 4092812, 3919256, 3438345, 8357888, 3421184, 5397364, 7983055, 6665025, 1055950, 166697, 6845588};

#elif NIMS_TRI_NTT_MODE == 3
//Q = 8397313
//zeta = 86054 //(2^9*3)th root of unity
//invMONT = 4329369 // 2^(-32) mod Q
//invzeta = 1755596 //zeta^(-1) mod Q
//W = 5661571 //zeta^(2^9) mod Q
#define MONT 3940353 // 2^32 % Q

#define Wmont	1050121 //mont * W (W : 3rd root of unity)
#define W2mont	3406839 //mont * W^2
#define	F1	2250740 //mont^2/2^9
#define F2	4501480 //mont^2/2^8

#define radix3_len 1 //radix-3 1번
#define radix2_redlen_ntt (N>>8)
#define radix2_redlen_invntt (N>>3)

int32_t zetas[511] = {
		4990474, 3227855, 2268138, 972348, 2337085, 124959, 4479337, 3667838, 5689912, 6644273,
6934194, 6934665, 1538485, 5896473, 152433, 971564, 6152987, 6328434, 6948882, 574790,
1459554, 5672534, 2982539, 383382, 2182644, 3631088, 6117417, 3514437, 3273452, 4262990,
2598551, 2624740, 3204729, 7745421, 1375023, 171112, 5348856, 1032490, 4589664, 2395811,
8343591, 6071282, 7365101, 4401765, 3583379, 2167158, 2285110, 5289144, 3923560, 7953169,
6722707, 4715825, 6465037, 5854021, 3783550, 5071907, 7765640, 892445, 6144516, 240402,
349876, 7886275, 4087106, 1235584, 7011869, 7497916, 4385583, 5168591, 6832874, 240718,
7123460, 3247067, 2567789, 70496, 656034, 1873626, 3512977, 1195040, 413771, 1924321,
655407, 7136014, 4078101, 476272, 2621588, 3456051, 8154728, 1434739, 7591357, 1545373,
7524556, 4408881, 395308, 2362032, 2300880, 4839465, 6374899, 4099598, 5945650, 6595643,
2290135, 5221968, 132753, 7121619, 3771421, 8169963, 4758324, 3398805, 375361, 6746501,
7808337, 3951210, 7984859, 2721906, 911361, 4486605, 4515839, 6133174, 4398986, 42606,
5516164, 8006412, 4059425, 6710531, 1783116, 3836780, 8104958, 4584505, 7432834, 3234870,
6858061, 4934201, 6097734, 4201686, 6901396, 8050176, 383341, 2806294, 6185977, 5867038,
2614166, 6786110, 2655361, 5533954, 4583186, 4546610, 430326, 3064313, 6284076, 6224373,
6963213, 7190978, 2271090, 6422994, 8213843, 2771607, 6190754, 6025246, 8046867, 8302794,
570546, 1327008, 6745812, 547559, 4076162, 5273742, 3184165, 4293535, 1289247, 6071198,
2375675, 1099499, 7458138, 2985263, 1376941, 1651505, 3963832, 7439099, 2260402, 8373167,
4117372, 3162151, 1919551, 621337, 1739534, 355419, 907301, 4746577, 7254367, 8041444,
4753267, 8285032, 6005209, 3191271, 1740753, 4591869, 8178904, 264532, 2479834, 5802854,
6196469, 1672317, 2149662, 117314, 3237267, 8013170, 370, 8179771, 4319762, 2114157,
4927297, 4393190, 2283578, 4205126, 7295526, 6246517, 1493570, 2939653, 5769134, 6845391,
8348858, 6241339, 5831293, 1416315, 4894611, 7795494, 8356971, 1904796, 2739086, 1298122,
1629867, 1421572, 2250284, 4222267, 3962274, 389160, 7092123, 3024641, 3496326, 6075004,
517124, 6618785, 8114979, 7703944, 1138889, 1240465, 28163, 1844240, 4686552, 2160386,
5512594, 7760014, 6244796, 7519805, 7161983, 8035435, 7116149, 5255994, 1053086, 5380821,
2490361, 3078953, 149966, 2662323, 6070477, 6586811, 7917965, 4318848, 2309794, 4944749,
6427458, 7066165, 1665386, 3238601, 5942938, 7455976, 1240339, 2153217, 7351999, 7424505,
5128736, 1964008, 4933934, 7542235, 5484370, 4126028, 4335755, 2123869, 8383463, 6596552,
5299166, 1587176, 4331708, 2144326, 7675927, 7611731, 1924818, 4287429, 6887651, 2501720,
534250, 1586814, 823900, 1723218, 731520, 5445059, 915930, 7412321, 1194060, 4420009,
5185427, 5793152, 935050, 1434946, 1292678, 6436655, 3310160, 6291589, 3533008, 7920168,
1306171, 2403825, 913285, 6464803, 578918, 8124486, 4454472, 4880977, 4491304, 605859,
1284361, 1368247, 1242552, 7739441, 6060253, 5769475, 3519455, 1997286, 8209646, 210912,
144531, 6115752, 7236238, 2474096, 4399603, 4172254, 2943434, 5812702, 6934208, 8172729,
5905199, 4419443, 1556603, 1645864, 5392445, 2845077, 2354190, 432934, 1610786, 2080041,
3459615, 6330916, 5622139, 7777805, 3132481, 5691738, 7623872, 2107815, 6104719, 747509,
8091014, 2992206, 1708614, 5120584, 1405816, 4056285, 4620372, 6172929, 3119643, 4697378,
5401179, 6573747, 3296606, 168330, 2051998, 1324483, 4918636, 5849556, 7885623, 6972914,
6775153, 2513543, 1620324, 3602798, 7611850, 4602204, 2454758, 4477162, 2042514, 506974,
4039870, 3843692, 4795871, 6223248, 4320007, 7775546, 310528, 7734180, 6067756, 5679474,
1336594, 2846921, 319669, 5340563, 8081606, 3320228, 4969396, 4516760, 6432898, 2805090,
1849375, 38833, 3936574, 3608060, 8263553, 3265463, 3601393, 613565, 751432, 7449517,
866476, 838550, 7268449, 4201000, 8140982, 7056512, 3513122, 7116264, 594751, 7541803,
6216020, 5034645, 6572193, 4971789, 3862199, 8261442, 7159345, 3078089, 1613266, 4307595,
7489368, 4734398, 6615721, 7318498, 7117080, 4183258, 1567826, 4814237, 2605671, 1768730,
7312956, 3179559, 6648041, 5648722, 547264, 3880333, 8090729, 4541000, 5499699, 2503695,
882585, 576849, 6797315, 8242450, 7912676, 1770164, 3717991, 46826, 7854881, 970128,
32227, 5694358, 4897114, 8162537, 5128047, 7533062, 4653092, 8298417, 3901556, 8025534,
5029744, 290396, 5638428, 7740179, 5510127, 3673401, 3227109, 8375539, 5853786, 4130252,
913983, 332254, 5112658, 3410573, 7191670, 1744337, 8155393, 723057, 3629549, 3962377,
4894760
};


int32_t merging_zetas[] = {4990474, 3227855, 2268138, 972348, 2337085, 124959, 4479337, 3667838, 971564, 6152987, 2624740, 3204729, 7745421, 1375023, 5689912, 6328434, 6948882, 171112, 5348856, 1032490, 4589664, 6644273, 574790, 1459554, 2395811, 8343591, 6071282, 7365101, 6934194, 5672534, 2982539, 4401765, 3583379, 2167158, 2285110, 6934665, 383382, 2182644, 5289144, 3923560, 7953169, 6722707, 1538485, 3631088, 6117417, 4715825, 6465037, 5854021, 3783550, 5896473, 3514437, 3273452, 5071907, 7765640, 892445, 6144516, 152433, 4262990, 2598551, 240402, 349876, 7886275, 4087106, 1235584, 4584505, 7432834, 8035435, 7116149, 5255994, 1053086, 7011869, 3234870, 6858061, 5380821, 2490361, 3078953, 149966, 7497916, 4934201, 6097734, 2662323, 6070477, 6586811, 7917965, 4385583, 4201686, 6901396, 4318848, 2309794, 4944749, 6427458, 5168591, 8050176, 383341, 7066165, 1665386, 3238601, 5942938, 6832874, 2806294, 6185977, 7455976, 1240339, 2153217, 7351999, 240718, 5867038, 2614166, 7424505, 5128736, 1964008, 4933934, 7123460, 6786110, 2655361, 7542235, 5484370, 4126028, 4335755, 3247067, 5533954, 4583186, 2123869, 8383463, 6596552, 5299166, 2567789, 4546610, 430326, 1587176, 4331708, 2144326, 7675927, 70496, 3064313, 6284076, 7611731, 1924818, 4287429, 6887651, 656034, 6224373, 6963213, 2501720, 534250, 1586814, 823900, 1873626, 7190978, 2271090, 1723218, 731520, 5445059, 915930, 3512977, 6422994, 8213843, 7412321, 1194060, 4420009, 5185427, 1195040, 2771607, 6190754, 5793152, 935050, 1434946, 1292678, 413771, 6025246, 8046867, 6436655, 3310160, 6291589, 3533008, 1924321, 8302794, 570546, 7920168, 1306171, 2403825, 913285, 655407, 1327008, 6745812, 6464803, 578918, 8124486, 4454472, 7136014, 547559, 4076162, 4880977, 4491304, 605859, 1284361, 4078101, 5273742, 3184165, 1368247, 1242552, 7739441, 6060253, 476272, 4293535, 1289247, 5769475, 3519455, 1997286, 8209646, 2621588, 6071198, 2375675, 210912, 144531, 6115752, 7236238, 3456051, 1099499, 7458138, 2474096, 4399603, 4172254, 2943434, 8154728, 2985263, 1376941, 5812702, 6934208, 8172729, 5905199, 1434739, 1651505, 3963832, 4419443, 1556603, 1645864, 5392445, 7591357, 7439099, 2260402, 2845077, 2354190, 432934, 1610786, 1545373, 8373167, 4117372, 2080041, 3459615, 6330916, 5622139, 7524556, 3162151, 1919551, 7777805, 3132481, 5691738, 7623872, 4408881, 621337, 1739534, 2107815, 6104719, 747509, 8091014, 395308, 355419, 907301, 2992206, 1708614, 5120584, 1405816, 2362032, 4746577, 7254367, 4056285, 4620372, 6172929, 3119643, 2300880, 8041444, 4753267, 4697378, 5401179, 6573747, 3296606, 4839465, 8285032, 6005209, 168330, 2051998, 1324483, 4918636, 6374899, 3191271, 1740753, 5849556, 7885623, 6972914, 6775153, 4099598, 4591869, 8178904, 2513543, 1620324, 3602798, 7611850, 5945650, 264532, 2479834, 4602204, 2454758, 4477162, 2042514, 6595643, 5802854, 6196469, 506974, 4039870, 3843692, 4795871, 2290135, 1672317, 2149662, 6223248, 4320007, 7775546, 310528, 5221968, 117314, 3237267, 7734180, 6067756, 5679474, 1336594, 132753, 8013170, 370, 2846921, 319669, 5340563, 8081606, 7121619, 8179771, 4319762, 3320228, 4969396, 4516760, 6432898, 3771421, 2114157, 4927297, 2805090, 1849375, 38833, 3936574, 8169963, 4393190, 2283578, 3608060, 8263553, 3265463, 3601393, 4758324, 4205126, 7295526, 613565, 751432, 7449517, 866476, 3398805, 6246517, 1493570, 838550, 7268449, 4201000, 8140982, 375361, 2939653, 5769134, 7056512, 3513122, 7116264, 594751, 6746501, 6845391, 8348858, 7541803, 6216020, 5034645, 6572193, 7808337, 6241339, 5831293, 4971789, 3862199, 8261442, 7159345, 3951210, 1416315, 4894611, 3078089, 1613266, 4307595, 7489368, 7984859, 7795494, 8356971, 4734398, 6615721, 7318498, 7117080, 2721906, 1904796, 2739086, 4183258, 1567826, 4814237, 2605671, 911361, 1298122, 1629867, 1768730, 7312956, 3179559, 6648041, 4486605, 1421572, 2250284, 5648722, 547264, 3880333, 8090729, 4515839, 4222267, 3962274, 4541000, 5499699, 2503695, 882585, 6133174, 389160, 7092123, 576849, 6797315, 8242450, 7912676, 4398986, 3024641, 3496326, 1770164, 3717991, 46826, 7854881, 42606, 6075004, 517124, 970128, 32227, 5694358, 4897114, 5516164, 6618785, 8114979, 8162537, 5128047, 7533062, 4653092, 8006412, 7703944, 1138889, 8298417, 3901556, 8025534, 5029744, 4059425, 1240465, 28163, 290396, 5638428, 7740179, 5510127, 6710531, 1844240, 4686552, 3673401, 3227109, 8375539, 5853786, 1783116, 2160386, 5512594, 4130252, 913983, 332254, 5112658, 3836780, 7760014, 6244796, 3410573, 7191670, 1744337, 8155393, 8104958, 7519805, 7161983, 723057, 3629549, 3962377, 4894760};
int32_t merging_zetas_inv[] = {3502553, 4434936, 4767764, 7674256, 1235330, 877508, 292355, 241920, 6652976, 1205643, 4986740, 2152517, 637299, 4560533, 3284655, 8065059, 7483330, 4267061, 2884719, 6236927, 6614197, 2543527, 21774, 5170204, 4723912, 3710761, 6553073, 1686782, 2887186, 657134, 2758885, 8106917, 8369150, 7156848, 4337888, 3367569, 371779, 4495757, 98896, 7258424, 693369, 390901, 3744221, 864251, 3269266, 234776, 282334, 1778528, 2881149, 3500199, 2702955, 8365086, 7427185, 7880189, 2322309, 8354707, 542432, 8350487, 4679322, 6627149, 4900987, 5372672, 3998327, 484637, 154863, 1599998, 7820464, 1305190, 8008153, 2264139, 7514728, 5893618, 2897614, 3856313, 4435039, 4175046, 3881474, 306584, 4516980, 7850049, 2748591, 6147029, 6975741, 3910708, 1749272, 5217754, 1084357, 6628583, 6767446, 7099191, 7485952, 5791642, 3583076, 6829487, 4214055, 5658227, 6492517, 5675407, 1280233, 1078815, 1781592, 3662915, 40342, 601819, 412454, 907945, 4089718, 6784047, 5319224, 3502702, 6980998, 4446103, 1237968, 135871, 4535114, 3425524, 2566020, 2155974, 588976, 1825120, 3362668, 2181293, 855510, 48455, 1551922, 1650812, 7802562, 1281049, 4884191, 1340801, 2628179, 5457660, 8021952, 256331, 4196313, 1128864, 7558763, 6903743, 2150796, 4998508, 7530837, 947796, 7645881, 7783748, 1101787, 4192187, 3638989, 4795920, 5131850, 133760, 4789253, 6113735, 4004123, 227350, 4460739, 8358480, 6547938, 5592223, 3470016, 6283156, 4625892, 1964415, 3880553, 3427917, 5077085, 4077551, 217542, 1275694, 315707, 3056750, 8077644, 5550392, 8396943, 384143, 8264560, 7060719, 2717839, 2329557, 663133, 5160046, 8279999, 3175345, 8086785, 621767, 4077306, 2174065, 6247651, 6724996, 6107178, 3601442, 4553621, 4357443, 7890339, 2200844, 2594459, 1801670, 6354799, 3920151, 5942555, 3795109, 5917479, 8132781, 2451663, 785463, 4794515, 6776989, 5883770, 218409, 3805444, 4297715, 1622160, 1424399, 511690, 2547757, 6656560, 5206042, 2022414, 3478677, 7072830, 6345315, 8228983, 2392104, 112281, 3557848, 5100707, 1823566, 2996134, 3699935, 3644046, 355869, 6096433, 5277670, 2224384, 3776941, 4341028, 1142946, 3650736, 6035281, 6991497, 3276729, 6688699, 5405107, 7490012, 8041894, 8002005, 306299, 7649804, 2292594, 6289498, 6657779, 7775976, 3988432, 773441, 2705575, 5264832, 619508, 6477762, 5235162, 872757, 2775174, 2066397, 4937698, 6317272, 4279941, 24146, 6851940, 6786527, 7964379, 6043123, 5552236, 6136911, 958214, 805956, 3004868, 6751449, 6840710, 3977870, 4433481, 6745808, 6962574, 2492114, 224584, 1463105, 2584611, 7020372, 5412050, 242585, 5453879, 4225059, 3997710, 5923217, 939175, 7297814, 4941262, 1161075, 2281561, 8252782, 8186401, 6021638, 2326115, 5775725, 187667, 6400027, 4877858, 2627838, 7108066, 4103778, 7921041, 2337060, 657872, 7154761, 7029066, 5213148, 3123571, 4319212, 7112952, 7791454, 3906009, 3516336, 4321151, 7849754, 1261299, 3942841, 272827, 7818395, 1932510, 1651501, 7070305, 7741906, 7484028, 5993488, 7091142, 477145, 7826767, 94519, 6472992, 4864305, 2105724, 5087153, 1960658, 350446, 2372067, 7983542, 7104635, 6962367, 7462263, 2604161, 2206559, 5625706, 7202273, 3211886, 3977304, 7203253, 984992, 183470, 1974319, 4884336, 7481383, 2952254, 7665793, 6674095, 6126223, 1206335, 6523687, 7573413, 6810499, 7863063, 5895593, 1434100, 2172940, 7741279, 1509662, 4109884, 6472495, 785582, 2113237, 5333000, 8326817, 721386, 6252987, 4065605, 6810137, 7966987, 3850703, 5829524, 3098147, 1800761, 13850, 6273444, 3814127, 2863359, 5150246, 4061558, 4271285, 2912943, 855078, 5741952, 1611203, 1273853, 3463379, 6433305, 3268577, 972808, 5783147, 2530275, 8156595, 1045314, 6244096, 7156974, 941337, 2211336, 5591019, 1564439, 2454375, 5158712, 6731927, 1331148, 8013972, 347137, 3228722, 1969855, 3452564, 6087519, 4078465, 1495917, 4195627, 4011730, 479348, 1810502, 2326836, 5734990, 2299579, 3463112, 899397, 8247347, 5318360, 5906952, 3016492, 1539252, 5162443, 1385444, 7344227, 3141319, 1281164, 361878, 964479, 3812808, 7161729, 4310207, 511038, 8047437, 8156911, 5798762, 4134323, 8244880, 2252797, 7504868, 631673, 3325406, 5123861, 4882876, 2500840, 4613763, 2543292, 1932276, 3681488, 2279896, 4766225, 6858828, 1674606, 444144, 4473753, 3108169, 6214669, 8013931, 1462648, 6112203, 6230155, 4813934, 3995548, 5414774, 2724779, 1463119, 1032212, 2326031, 53722, 6001502, 6937759, 7822523, 1753040, 3807649, 7364823, 3048457, 8226201, 1448431, 2068879, 2707401, 7022290, 651892, 5192584, 5772573, 2244326, 7425749, 4729475, 3917976, 8272354, 6060228, 7424965, 6129175, 5169458, 3584677};

#elif NIMS_TRI_NTT_MODE == 5
// Q = 8380417
#define MONT 4193792	// 2^32 % Q

#define F1 6290560	// mont^2/2^9
#define F2 4200703	// mont^2/2^8

int32_t merging_zetas[] ={7561323, 5706650, 2647920, 7144876, 2439577, 4535982, 2958486,
		8005842, 7752683, 1006927, 1508753, 5147713, 772140, 1239593, 2230497, 3170710, 6015733, 5298825, 4833419, 828607, 5698961, 5636984, 4897610, 2678231, 642166, 5370442, 3023997, 600663, 5743245, 4405340, 882799, 1776800, 7501025, 6697564, 6714808, 3008457, 2005433, 5262615, 8089440, 5149473, 2213667, 973043, 137451, 5926336, 3360378, 2422249, 7895776, 6034082, 307760, 4866997, 4612763, 7525073, 1594819, 8114369, 3641288, 4485431, 2276965, 1786113, 5358334, 7127679, 7757673, 880668, 986500,
		6926829, 4637099, 2698043, 4417095, 6474994, 4183454, 2830498, 7789161, 2671590, 5310391, 6342258, 5365054, 3124956, 5797342, 3967585, 7815823, 624009, 5837589, 2080490, 7799182, 5939264, 3074383, 4083750, 5631006, 2820475, 947258, 5814606, 4624630, 5049541, 6932733, 4684164, 2668922, 3153556, 6720925, 5223825, 1525090, 3835287, 1971810, 7955237, 3860689, 7063357, 1122756, 680045, 3970701, 4927475, 380460, 2216022, 6566141, 5411819, 7392577, 4460286, 2501200, 2699890, 6251020, 5459209, 5038846, 2344290, 2139434, 5678215, 4112203, 14232, 647891, 8129637, 2219829, 3868967, 5175998, 1575469, 7278735, 2286383, 7715796, 1413362, 7209768, 419856, 1189629, 2799154, 5867774, 7186623, 3359157, 3256960, 4218478, 1633718, 8322569, 654655, 1523381, 8362615, 2486766, 7159150, 6065655, 2452553, 2876001, 4492000, 6270767, 7452817, 6066166, 2979846, 2830930, 5533668, 3136040, 5457821, 1064630, 3874971, 569605, 7595149, 5680477, 7887421, 8000186, 3800072, 4578452, 6280746, 5317618, 8250670, 2125021, 4832822, 4792693, 4766814, 5949643, 1718944, 7303869, 3270092, 7470796, 8343283, 2691811, 5737300, 1854376, 5512763, 3710112, 6027456, 687142, 317366, 8127220, 5499045, 5443738, 8026928, 5436187, 5354706, 2693942, 1400886, 3362615, 3918841, 6940897, 1995951, 7365035, 7630086, 6454333, 4596438, 6197663, 6782164, 7089643, 2454784, 2167708, 8084377, 3924310, 6361189, 1153477, 6314822, 2966118, 5553870, 966983, 5112481, 256437, 3528015, 6831641, 7612758, 7675617, 6048182, 2345890, 5569883, 2694756, 794451, 4243388, 5930681, 3030346, 3236088, 3028029, 6247393, 3341276, 7397419, 7223450, 5321653, 1702236, 2894789, 657971, 6768418, 4300953, 2275330, 7017725, 933887, 6200467, 316724, 7649016, 5678818, 6524283, 6949676, 5486879, 2078761, 2536590, 3599124, 6988129, 4762851, 3823608, 8075636, 4119751, 3351947, 6509600, 5921147, 4577635, 3085520, 6420884, 8099703, 2549747, 7071962, 2894, 4959201, 1917444, 4853070, 1967560, 7912984, 732115, 8037356, 3124558, 1261629, 7857424, 4867585, 7639839, 4977297, 7863844, 3589119, 1494163, 4227466, 3648403, 3047315, 4788193, 4191505, 1206727, 1196936, 33660, 3475505, 1187544, 5716932, 1084777, 2430556, 4798678, 6077702, 2818109, 4908393, 1596706, 2891552, 2347580, 4601311, 3242654, 282617, 7252852, 180811, 2028435, 3547376, 3606120, 7378214, 8107530, 5268056, 1713829, 442837, 8242897, 6580172, 3998655, 138659, 4702589, 1804991, 4247785, 8093754, 6668555, 3954006, 2799748, 465332, 4568529, 3826922, 4893437, 3982831, 856158, 242411, 6041460, 2600011, 153355, 7159709, 2460448, 4912142, 1439287, 1252165, 4063361, 5963171, 5267266, 7259108, 5352749, 3593498, 5422968, 3396392, 4874498, 5328539, 928866, 7703806, 3219869, 1287955, 4711836, 6762842, 804360, 2850072, 690517, 1475022, 4129326, 3525356, 7650430, 7724287, 2784724, 7957865, 134525, 3427461, 4595484, 4800553, 8042644, 3737220, 2970303, 5203882, 2741120, 3387848, 2744850, 2705295, 4066134, 5901891, 1768220, 5012654, 5117238, 6268629, 5545332, 5644487, 7558848, 7998497, 3338189, 270397, 5710170, 6966991, 7325949, 1469128, 5993514, 4916277, 8279945, 4002882, 75432, 5838619, 2467117, 2024501, 4381403, 4141039, 3381281, 3115980, 2536601, 3694024, 905299, 2413130, 4931313, 8208929, 6724459, 281902, 760175, 3874716, 1483958, 5290083, 1720200, 5619767, 3487674, 2346252, 47703, 6734908, 1893695, 1175232, 4123752, 6216740, 4529291, 1469168, 1476299, 2438269, 6439632, 1039037, 1355833, 1527864, 5266226, 8210474, 5040543, 2186416, 1247942, 6442785, 977708, 3946850, 7536341, 2412876, 2194960, 842540, 2804691, 425002, 967442, 2201106, 5215512, 506914, 2866130, 5210009, 102237, 3613704, 5229285, 5787052, 4944254, 5997049, 3307235, 5393493, 6376326, 3442544, 3589753, 4007400, 7076221, 3565972, 3845331, 5997946, 6400900, 4346555, 3983789, 3835656, 4634103, 2110444, 4839507, 3593101, 4242930, 192555, 1533239, 4297986, 4717194, 7985191, 5064175, 7819488, 6190344, 202650, 6432983, 7810505, 7431224, 4412995, 2609950, 3752636, 4639964, 7647839, 4074862, 5145341, 6160295,
		3541077, 2988639, 3584853, 6338950, 3011578, 3090824, 5911369, 6685864, 4845287, 4959197, 3368592, 4853886, 3033271, 4452365, 7591026, 1608364, 2365437, 2940772, 1966033, 6619861, 2062496, 399513, 2079678, 1522034, 747679, 7439887, 1700863, 3700849, 2355911, 6817911, 3376463, 7252911, 968115, 5522084, 7817531, 1037317, 6649688, 1144917, 3931981, 2136179, 7687291, 1943969, 8085550, 2649943, 3506769, 3933389, 1357704, 5964748, 3357178, 1016737, 5611887, 2229269, 7482212, 4936241, 3812196, 272445, 8088608, 4215048, 6116440, 6910809, 6647117, 1592026, 3591760, 2887878, 6778397, 4568415, 8236845, 1948900, 8068622, 1939427, 1012865, 1652481, 7873657, 2886504, 4423260, 2529107, 4337854, 5297260, 181689, 2081448, 5522326, 3849665, 5889408, 4453431, 6002791, 2089782, 807207, 8260230, 3198753, 2360504, 968841, 2201778, 2767152, 5012551, 2426528, 7557385, 1536541, 4364138, 3414524, 4041072, 8251603, 7983531, 5134560, 6082978, 3072454, 2040247, 5823525, 2936133, 947871, 3398461, 4113429, 8043804, 1226365, 3033479, 5817424, 6564075, 8346478, 6268227, 7957140, 5282871, 3643798, 3805968, 6417339, 3718971, 7172237, 1229609, 4782040, 6104483, 445430, 5348792, 995289, 2345197, 7962119, 7747016, 4306658, 8136314, 6457387, 2862546, 6687710, 6307877, 3777226, 3780766, 5141647, 1144891, 2164657, 3092473, 4531415, 1615360, 6618135, 4392510, 5810509, 5108987, 4507185, 1435081, 1295449, 8347812, 1181313, 4564086, 7698435, 4770951, 6348845, 3387019, 841910, 1114918, 1206383, 1636723, 8373709, 5520736, 8131869, 1109420, 4821777, 2777278, 2063974, 1843440, 2787396, 4105801, 800579, 7642758, 4760123, 2792915, 971529, 6226911, 121312, 3190093, 3214286, 2959406, 4043855, 1788871, 2178976, 785506, 6821681, 5975097, 2590114, 2611562, 1637926, 6751653, 170910, 6874063, 1514545, 5286890, 1533193, 4213756, 1064821, 7355787, 3051367, 6566324, 5456102, 6399451, 3378707, 1531427, 4558407, 8048908, 4271346, 1653158, 5495232, 5924940, 1735528, 1309050, 4495069, 3009233, 2399713, 6563950, 377536, 2193722, 3290642, 7415969, 3265672, 556516, 2026249, 6765512, 1725224, 5216542, 448266, 1176209, 7344913, 5377283, 8019822, 6195489, 5230906, 4472049, 6379686, 633810, 6920408, 5354680, 6765536, 3654406, 6408337, 6074456, 6643009, 3083032, 5304764, 1049972, 4225703, 4442059, 7432669, 2750272, 4021501, 4306157, 409743, 2143956, 1826645, 3257137, 1184243, 4243508, 8090254, 7869483, 832148, 4934296, 4527885, 7868339, 5233044, 3949324, 3876108, 7324936, 4698000, 7406063, 6247959, 7920100, 166547, 7550109, 6337583, 7393610, 5740511, 7088998, 6915306, 7851973, 2596269, 3570010, 6334463, 7120023, 4119056, 8012460, 6230369, 133788, 5210204, 1633598, 7057076, 1111111, 1815613, 2193059, 3643322, 5781356, 3860021, 4565474, 8363733, 2557172, 7711090, 8269830, 3052062, 6329098, 4320498, 4119838, 1738406, 2261212, 4784656, 1095368, 8186278, 5227421, 6893603, 1695354, 7163556, 573317, 1033618, 2827618, 7995742, 366476, 3915327, 473382, 1065441, 1323542, 2785945, 3052209, 5641514, 3444891, 3954727, 4496626, 3410410, 5083468, 7124574, 7142275, 541520, 3684101, 3368831, 5160574, 7785673, 3812649, 6291362, 6650061, 5027898, 3655403, 1443987, 5629943, 3548252, 1343372, 6005341, 7465381, 1962486, 7915601, 1256602, 1145617, 5765651, 2788436, 1849530, 609204, 1096059, 2825089, 7361501, 901365, 3247157, 4302006, 5718304, 142717, 204188, 7415386, 3740288, 7095912, 971647, 5691557, 7359228, 4814440, 3434805, 5263200, 335740, 8292733, 7514705, 678807, 1460262, 22313, 4283848, 1021262, 71851, 5244620, 2020489, 763314, 3562052, 4407978, 1166918, 6851315, 3803935, 4859578, 2928701, 2956612, 8116929, 4858168, 7009686, 261114, 1331745, 3941996, 3901915, 4263113, 5483220, 8203054, 3029226, 8185654, 2021526, 4409871, 4039985, 3386734, 325456, 2919112, 75255, 3861591, 4490198, 625339, 8319014, 3825689, 7315806, 403215, 6485904, 5334347, 2215218, 2035279, 2293490, 6326229, 1211531, 2841147, 6933394, 2645973, 6821396, 1287027, 402319, 1921999, 3020959, 827204, 2633242, 2490801, 6761715, 3999069, 8222585, 6594390, 8315340, 4585655, 7422424, 3211409, 7605765, 762838, 2416367, 527608, 2790535, 5785509, 4279466, 2159032, 5115496, 6426124, 1891839, 449517, 2137083, 4559776, 1130927, 2771706, 7692784, 958782, 7915239, 8194985, 4758764, 7455962, 2568304, 403301, 3968731, 7198445, 631269, 2242616, 7291307, 5893376, 2050812, 6764101, 2436383, 3412782, 7853644, 5683233, 533562, 2307931, 4324436, 1829590, 629444, 813869, 2988019, 1236681, 7693417, 645232, 4601141, 4113280, 4369063, 6117516, 532892, 5857804, 515146, 5717783, 2880619, 8357158, 1765034, 3543901, 4274634, 4516462, 2055325, 4284192, 3030483, 2122630, 6969894, 6566453, 509529, 64320, 7149873, 3512444, 5867276, 2549698, 7628924, 6779088, 1282311, 1965418, 7532039, 6817238, 1272961, 2493933, 5068440, 5054593, 5357885, 328215, 5438382, 7692551, 232335, 2103246, 2004516, 6213527, 5349854, 970302, 4477261, 3420704, 6336041, 289213, 6857113, 7542482, 1594804, 1497545, 924338, 4813526, 3612363, 96349, 5881512, 5643530, 8151573, 6664245, 3429449, 3231600, 4030347, 1871907, 428289, 1638308, 1293142, 5179262, 3140760, 7913351, 1693229, 2340305, 4169439, 2736311, 4763946, 5779657, 2075052, 7702151, 3430900, 7429467, 269206, 6070706, 2713125, 2633771, 3872825, 1026367, 4793178, 3884460, 5353069, 2548650, 5379306, 2327080, 5746182, 7772978, 285245, 2080300, 5858592, 7987175, 2911129, 4164387, 7283933, 1177386, 5315309, 167092, 2846378, 3122913, 7088960, 4055530, 5436384, 2125864, 8335446, 5866249, 6817598, 6153357, 7077474, 5225758, 8096439, 4215081, 5125742, 8354339, 3446913, 4709924, 256983, 5810961, 7039813, 1324612, 594585, 7045473, 5696414, 3666344, 7251359, 1852274, 2034098, 2719587, 6015180, 2292163, 5817248, 7548800, 1641760, 8070459, 7234878, 3500282, 4572878, 3336235, 423804, 65242, 3945972, 264599, 4541398, 5400505, 733699, 2928212, 253592, 8143735, 2626210, 5999401, 2799712, 5951976, 6275955, 125457, 821002, 3608739, 6855171, 890275, 4738437, 3272518, 1938368, 4139685, 1587199, 7369525, 7501727, 4621028, 7739077, 179063, 7724405, 3231451, 7465579, 2951200, 6202859, 5307612, 253639, 6285542, 4764795, 5499550, 2436157, 6808524, 5236334, 2213555, 854866, 7074455, 6281200, 6695237, 6274886, 6372504, 6514731, 6515585, 6092181, 5885527, 3587358, 3525037, 954967, 3182768, 4537287, 5776787, 2513877, 1217634, 7858340, 7648505, 3136952, 2532009, 4568316, 8309874, 453943, 7513926, 7939457, 77040, 2999174, 501411, 4180115, 6665493, 2251365, 511292, 8120317, 1630490, 647753, 6949734, 3165388, 1227049, 2355673, 3050954, 5881297, 3149134, 6427434, 1254247, 6941084, 2033917, 608263, 2556585, 6606450, 1700140, 7021018, 6539175, 8064595, 6547105, 3278329, 1885068, 337402, 3611706, 5833566, 125735, 5009790, 3442516, 5003660, 176896, 1023217, 5745385, 4360349, 6905173, 4812075, 2587746, 3453399, 682417, 8103946, 2295297, 7070238, 1826158, 7702088, 4854167, 3156448, 4837681, 2747164, 5738155, 310128, 1400045, 7692775, 5529646, 8284034, 7863036, 7976773, 7907366, 382341, 3027157, 1314196, 519729, 1516186, 5759390, 2253974, 8320216, 5500378, 1949600, 3712331, 5070443, 6995183, 1756009, 7132894, 7233627, 2545132, 5757811, 1734498, 7132225, 7787004, 6152217, 3058653, 7228211, 4470608, 4041027, 3749293, 4792700, 6978535, 5756504, 731306, 380502, 2413875, 3808647, 2269448, 1986749, 3489071, 1969197, 3994406, 359905, 5605697, 6596094, 3043082, 2843356, 4488763, 7194025, 6140710, 3261380, 4738510, 968737, 7940405, 1645427, 3746320, 4893258, 2037270, 2562060, 1255165, 5056787, 464764, 5364819, 607454, 4618919, 1785572, 281601, 2178813, 4588132, 6098443, 2567970, 5849762, 767256, 7757743, 5747218, 7139431, 8276255, 2582213, 7862186, 4499483, 381539, 1652819, 2918895, 736423, 3999527, 7337214, 795398, 547989, 8179206, 7244004, 3621203, 8049107, 8070510, 4552856, 2808278, 5175826, 1859535, 2179025, 6724544, 2115431, 5641716, 6271895, 6885186, 5920060, 3460961, 5361632, 1704305, 8331181, 6220368, 4600283, 2686008, 3578723, 1620056, 6514070, 7923718, 5199907, 4515150, 4511910, 7961510, 427665, 6632280, 1734131, 1943790, 6557318, 7342234, 4358033, 838143, 65334, 7553171, 3835099, 1384449, 2531404, 1474748, 6540081, 4803047, 403118, 2952475, 2870669, 6086805, 2924891, 5018009, 3374351, 2584190, 693930, 4020709, 4588795, 3251584, 7863394, 2824281, 472189, 4354889, 2368615, 5161637, 349404, 431, 7320772, 3650976, 1575141, 4330612, 5605573, 467554, 8281781, 4844937, 431418, 535661, 8311210, 4517999, 536200, 6243497, 1638984, 6869066, 8099386, 5612722, 6763725, 4040477, 5856742, 4646461, 7985939, 3143221, 3444062, 2508806, 1243677, 2868073, 1337099, 6261012, 7081592, 8008237, 7586395, 4347860, 6482093, 3906497, 5669591, 5802723, 5929270, 2500699, 7645646, 360993, 5485528, 2477660, 4532568, 1913966, 439470, 895899, 1256283, 1343192, 2949030, 7973388, 3994033, 6364674, 7028521, 8354778, 296587, 5300568, 4568277, 5824927, 3659672, 7285451, 3805810, 519191, 4325740, 3494044, 4839971, 1782007, 7862790, 1480130, 6876601, 1273310, 6583157, 7193886, 895413, 4436115, 1735418, 2493790, 4540785, 5631956, 1286735, 3343661, 4453732, 4865328, 3430914, 7158087, 2319937, 350097, 6546304, 4981987, 4069798, 4315609, 3625500, 3308455, 5688713, 6435117, 2953670, 5014568, 4067766, 357275, 3886978, 2999595, 2506538, 6997830, 6092192, 475169, 6449839, 7637617, 4174188, 5259330, 713195, 5973160, 4387227, 2912400, 3123238, 3183472, 3456497, 2768633, 217358, 6891711, 5380833, 1460134, 5007764, 4959802, 1516377, 3230755, 1081281, 760278, 5531028, 7999399, 7403207, 436445, 6374689, 5244559, 7638414, 7250973, 224383, 8176, 587710, 2634158, 2049226, 6116716, 3955151, 6380315, 7094488, 8243796, 1164601, 2191815, 4340402, 7870883, 3697333, 1561336, 8324988, 829087, 2380516, 7744209, 189587, 402880, 6025404, 2961283, 5895102, 8099466, 6202293, 3231496, 7210177, 1351059, 1883857, 3266505, 7036795, 7197121, 2937418, 2204924, 2841513, 394931, 2997622, 4247369, 341035, 4168242, 798050, 231932, 7826514, 1699833, 1181043, 1595493, 2232575, 4018696, 8015116, 3238198, 7644274, 7186208, 3373907, 7333707, 4920455, 1611920, 2929385, 3665734, 7103749, 7655797, 3745426, 1933575, 3890808, 342672, 6810334, 4416271, 6765634, 1754746, 3455162, 3834894, 5998227, 6431279, 1362947, 4897942, 1162328, 410024, 1401760, 451660, 3802883, 6357739, 1766624, 4141970, 3645377, 2428306, 7234242, 2495414, 2905715, 6958001, 2143421, 3164500, 7436574, 74868, 250385, 3710181, 6318948, 5910279, 2394587, 6559997, 1648377, 3269834, 1288884, 4313693, 4088792, 7263239, 5172625, 7125807, 8128983, 6442917, 7259029, 8081310, 6608972, 917353, 3406626, 6021963, 6915756, 8132122, 4982450, 2113994, 5567043, 677163, 6959970, 4680645, 4888900, 275738, 5313479, 5104222, 6522423, 4037500, 7975037, 1532066, 8178783, 3156609, 241221, 3967509, 8254878, 7136778, 3777207, 7951724, 1264427, 5099897, 5555669, 6785453, 1879567, 4063637, 4046849, 2609076, 3260568, 4833530, 5718746, 3717716, 4206054, 6513337, 2142505, 7156504, 6901969, 6009195, 657747, 1447291, 7260764, 5584878, 553177, 4379635, 6026915, 359454, 1073014, 6322542, 4440854, 1782245, 7825098, 5203933, 4815893, 904685, 4737462, 6396701, 7120134, 6756210, 6033101, 6435327, 684217, 7351720, 8219012, 6416702, 5235003, 565150, 7753567, 7661598, 593645, 1322653, 7066135, 4028839, 3334155, 2344522, 4321465, 5727675, 2963804, 6247914, 6027997, 2521010, 4080766, 6007998, 6831715, 917329, 1477444, 6617170, 443614, 1561724, 8182667, 7331548, 6670743, 3391931, 6716880, 3420698, 5419099, 6828376, 4297964, 3163765, 2355426, 655658, 4611841, 8175440, 7001087, 7439348, 8235467, 7101329, 7607419, 3027510, 4335813, 1025695, 3648002, 3637199, 2315095, 1320356, 6818784, 5458909, 7829833, 7998332, 8049260, 7529279, 2449911, 4631292, 4054716, 5749216, 5441922, 5317153, 338542, 7312718, 4528629, 629645, 771344, 2724848, 2536191, 7091865, 7869429, 681697, 2792234, 4481073, 7806081, 1257361, 6207596, 6987645, 7424029, 4405743, 7437361, 5007449, 1712493, 4166951, 4090963, 7122077, 219806, 2293230, 5633597, 7946092, 4171215, 6791441, 5526707, 3028690, 1425797, 7742062, 2947968, 7691082, 1487490, 612332, 358030, 2421069, 3442300, 6434912, 1545481, 1945047, 5948679, 2447359, 729463, 7056885, 3266003, 6024686, 4459938, 8049729, 2093312, 5510177, 1160968, 6607229, 4245895, 2827969, 6759115, 7437762, 3384790, 3611852, 4058604, 8201271, 2010963, 1820349, 179264, 7012936, 4816102, 7134195, 6898232, 6569474, 3058521, 1830843, 2235019, 4903422, 1648171, 3356034, 5249653, 5912451, 8175662, 3894978, 2036965, 1723439, 2694187, 3413354, 7969938, 7418090, 5145865, 7347167, 4405394, 791739, 2684840, 4669925, 5709679, 2483803, 7129072, 4512651, 8044408, 2907652, 1072721, 611777, 627096, 2673031, 3293320, 2163675, 527211, 368823, 7505708, 908477, 4757351, 6243653, 7098548, 6389204, 6421425, 4967349, 7347647, 1086949, 6578157, 6892440, 2764800, 4747513, 1033423, 1818744, 1042685, 920255, 3421943, 1861854, 3143131, 7859868, 4504737, 4775586, 4748717, 7624874, 4982118, 4718341, 1481281, 2695472, 4495017, 3720527, 5461686, 3714865, 3409031, 1059742, 7637975, 351537, 4159426, 1687168, 1344079, 186226, 3298938, 7888309, 5984576, 5775873, 7522516, 877906, 6637800, 4247973, 1795430, 743701, 6342193, 6325112, 116932, 7822235, 3912290, 3432288, 1658704, 3614630, 2843068, 4064980, 5390220, 3869018, 2159728, 6416339, 2409091, 1384310, 2523842, 6788830, 2795336, 3467055, 2165228, 3381833, 2170491, 8247680, 2456725, 6366425, 222361, 5247692, 5226428, 6273508, 1003195, 1345835, 3779564, 2334945, 590331, 4504852, 2537657, 7803914, 6397411, 4773862, 1554298, 4628610, 745369, 4086902, 1997454, 6576464, 7003347, 3087386, 5471483, 4540854, 702833, 4162204, 1486888, 3978258, 7344329, 4269974, 1785498, 6741090, 7465976, 7189670};
int32_t merging_zetas_inv[] = {1190747, 914441, 1639327, 6594919, 4110443, 1036088, 4402159, 6893529, 4218213, 7677584, 3839563, 2908934, 5293031, 1377070, 1803953, 6382963, 4293515, 7635048, 3751807, 6826119, 3606555, 1983006, 576503, 5842760, 3875565, 7790086, 6045472, 4600853, 7034582, 7377222, 2106909, 3153989, 3132725, 8158056, 2013992, 5923692, 132737, 6209926, 4998584, 6215189, 4913362, 5585081, 1591587, 5856575, 6996107, 5971326, 1964078, 6220689, 4511399, 2990197, 4315437, 5537349, 4765787, 6721713, 4948129, 4468127, 558182, 8263485, 2055305, 2038224, 7636716, 6584987, 4132444, 1742617, 7502511, 857901, 2604544, 2395841, 492108, 5081479, 8194191, 7036338, 6693249, 4220991, 8028880, 742442, 7320675, 4971386, 4665552, 2918731, 4659890, 3885400, 5684945, 6899136, 3662076, 3398299, 755543, 3631700, 3604831, 3875680, 520549, 5237286, 6518563, 4958474, 7460162, 7337732, 6561673, 7346994, 3632904, 5615617, 1487977, 1802260, 7293468, 1032770, 3413068, 1958992, 1991213, 1281869, 2136764, 3623066, 7471940, 874709, 8011594, 7853206, 6216742, 5087097, 5707386, 7753321, 7768640, 7307696, 5472765, 336009, 3867766, 1251345, 5896614, 2670738, 3710492, 5695577, 7588678, 3975023, 1033250, 3234552, 962327, 410479, 4967063, 5686230, 6656978, 6343452, 4485439, 204755, 2467966, 3130764, 5024383, 6732246, 3476995, 6145398, 6549574, 5321896, 1810943, 1482185, 1246222, 3564315, 1367481, 8201153, 6560068, 6369454, 179146, 4321813, 4768565, 4995627, 942655, 1621302, 5552448, 4134522, 1773188, 7219449, 2870240, 6287105, 330688, 3920479, 2355731, 5114414, 1323532, 7650954, 5933058, 2431738, 6435370, 6834936, 1945505, 4938117, 5959348, 8022387, 7768085, 6892927, 689335, 5432449, 638355, 6954620, 5351727, 2853710, 1588976, 4209202, 434325, 2746820, 6087187, 8160611, 1258340, 4289454, 4213466, 6667924, 3372968, 943056, 3974674, 956388, 1392772, 2172821, 7123056, 574336, 3899344, 5588183, 7698720, 510988, 1288552, 5844226, 5655569, 7609073, 7750772, 3851788, 1067699, 8041875, 3063264, 2938495, 2631201, 4325701, 3749125, 5930506, 851138, 331157, 382085, 550584, 2921508, 1561633, 7060061, 6065322, 4743218, 4732415, 7354722, 4044604, 5352907, 772998, 1279088, 144950, 941069, 1379330, 204977, 3768576, 7724759, 6024991, 5216652, 4082453, 1552041, 2961318, 4959719, 1663537, 4988486, 1709674, 1048869, 197750, 6818693, 7936803, 1763247, 6902973, 7463088, 1548702, 2372419, 4299651, 5859407, 2352420, 2132503, 5416613, 2652742, 4058952, 6035895, 5046262, 4351578, 1314282, 7057764, 7786772, 718819, 626850, 7815267, 3145414, 1963715, 161405, 1028697, 7696200, 1945090, 2347316, 1624207, 1260283, 1983716, 3642955, 7475732, 3564524, 3176484, 555319, 6598172, 3939563, 2057875, 7307403, 8020963, 2353502, 4000782, 7827240, 2795539, 1119653, 6933126, 7722670, 2371222, 1478448, 1223913, 6237912, 1867080, 4174363, 4662701, 2661671, 3546887, 5119849, 5771341, 4333568, 4316780, 6500850, 1594964, 2824748, 3280520, 7115990, 428693, 4603210, 1243639, 125539, 4412908, 8139196, 5223808, 201634, 6848351, 405380, 4342917, 1857994, 3276195, 3066938, 8104679, 3491517, 3699772, 1420447, 7703254, 2813374, 6266423, 3397967, 248295, 1464661, 2358454, 4973791, 7463064, 1771445, 299107, 1121388, 1937500, 251434, 1254610, 3207792, 1117178, 4291625, 4066724, 7091533, 5110583, 6732040, 1820420, 5985830, 2470138, 2061469, 4670236, 8130032, 8305549, 943843, 5215917, 6236996, 1422416, 5474702, 5885003, 1146175, 5952111, 4735040, 4238447, 6613793, 2022678, 4577534, 7928757, 6978657, 7970393, 7218089, 3482475, 7017470, 1949138, 2382190, 4545523, 4925255, 6625671, 1614783, 3964146, 1570083, 8037745, 4489609, 6446842, 4634991, 724620, 1276668, 4714683, 5451032, 6768497, 3459962, 1046710, 5006510, 1194209, 736143, 5142219, 365301, 4361721, 6147842, 6784924, 7199374, 6680584, 553903, 8148485, 7582367, 4212175, 8039382, 4133048, 5382795, 7985486, 5538904, 6175493, 5442999, 1183296, 1343622, 5113912, 6496560, 7029358, 1170240, 5148921, 2178124, 280951, 2485315, 5419134, 2355013, 7977537, 8190830, 636208, 5999901, 7551330, 55429, 6819081, 4683084, 509534, 4040015, 6188602, 7215816, 136621, 1285929, 2000102, 4425266, 2263701, 6331191, 5746259, 7792707, 8372241, 8156034, 1129444, 742003, 3135858, 2005728, 7943972, 977210, 381018, 2849389, 7620139, 7299136, 5149662, 6864040, 3420615, 3372653, 6920283, 2999584, 1488706, 8163059, 5611784, 4923920, 5196945, 5257179, 5468017, 3993190, 2407257, 7667222, 3121087, 4206229, 742800, 1930578, 7905248, 2288225, 1382587, 5873879, 5380822, 4493439, 8023142, 4312651, 3365849, 5426747, 1945300, 2691704, 5071962, 4754917, 4064808, 4310619, 3398430, 1834113, 8030320, 6060480, 1222330, 4949503, 3515089, 3926685, 5036756, 7093682, 2748461, 3839632, 5886627, 6644999, 3944302, 7485004, 1186531, 1797260, 7107107, 1503816, 6900287, 517627, 6598410, 3540446, 4886373, 4054677, 7861226, 4574607, 1094966, 4720745, 2555490, 3812140, 3079849, 8083830, 25639, 1351896, 2015743, 4386384, 407029, 5431387, 7037225, 7124134, 7484518, 7940947, 6466451, 3847849, 5902757, 2894889, 8019424, 734771, 5879718, 2451147, 2577694, 2710826, 4473920, 1898324, 4032557, 794022, 372180, 1298825, 2119405, 7043318, 5512344, 7136740, 5871611, 4936355, 5237196, 394478, 3733956, 2523675, 4339940, 1616692, 2767695, 281031, 1511351, 6741433, 2136920, 7844217, 3862418, 69207, 7844756, 7948999, 3535480, 98636, 7912863, 2774844, 4049805, 6805276, 4729441, 1059645, 8379986, 8031013, 3218780, 6011802, 4025528, 7908228, 5556136, 517023, 5128833, 3791622, 4359708, 7686487, 5796227, 5006066, 3362408, 5455526, 2293612, 5509748, 5427942, 7977299, 3577370, 1840336, 6905669, 5849013, 6995968, 4545318, 827246, 8315083, 7542274, 4022384, 1038183, 1823099, 6436627, 6646286, 1748137, 7952752, 418907, 3868507, 3865267, 3180510, 456699, 1866347, 6760361, 4801694, 5694409, 3780134, 2160049, 49236, 6676112, 3018785, 4919456, 2460357, 1495231, 2108522, 2738701, 6264986, 1655873, 6201392, 6520882, 3204591, 5572139, 3827561, 309907, 331310, 4759214, 1136413, 201211, 7832428, 7585019, 1043203, 4380890, 7643994, 5461522, 6727598, 7998878, 3880934, 518231, 5798204, 104162, 1240986, 2633199, 622674, 7613161, 2530655, 5812447, 2281974, 3792285, 6201604, 8098816, 6594845, 3761498, 7772963, 3015598, 7915653, 3323630, 7125252, 5818357, 6343147, 3487159, 4634097, 6734990, 440012, 7411680, 3641907, 5119037, 2239707, 1186392, 3891654, 5537061, 5337335, 1784323, 2774720, 8020512, 4386011, 6411220, 4891346, 6393668, 6110969, 4571770, 5966542, 7999915, 7649111, 2623913, 1401882, 3587717, 4631124, 4339390, 3909809, 1152206, 5321764, 2228200, 593413, 1248192, 6645919, 2622606, 5835285, 1146790, 1247523, 6624408, 1385234, 3309974, 4668086, 6430817, 2880039, 60201, 6126443, 2621027, 6864231, 7860688, 7066221, 5353260, 7998076, 473051, 403644, 517381, 96383, 2850771, 687642, 6980372, 8070289, 2642262, 5633253, 3542736, 5223969, 3526250, 678329, 6554259, 1310179, 6085120, 276471, 7698000, 4927018, 5792671, 3568342, 1475244, 4020068, 2635032, 7357200, 8203521, 3376757, 4937901, 3370627, 8254682, 2546851, 4768711, 8043015, 6495349, 5102088, 1833312, 315822, 1841242, 1359399, 6680277, 1773967, 5823832, 7772154, 6346500, 1439333, 7126170, 1952983, 5231283, 2499120, 5329463, 6024744, 7153368, 5215029, 1430683, 7732664, 6749927, 260100, 7869125, 6129052, 1714924, 4200302, 7879006, 5381243, 8303377, 440960, 866491, 7926474, 70543, 3812101, 5848408, 5243465, 731912, 522077, 7162783, 5866540, 2603630, 3843130, 5197649, 7425450, 4855380, 4793059, 2494890, 2288236, 1864832, 1865686, 2007913, 2105531, 1685180, 2099217, 1305962, 7525551, 6166862, 3144083, 1571893, 5944260, 2880867, 3615622, 2094875, 8126778, 3072805, 2177558, 5429217, 914838, 5148966, 656012, 8201354, 641340, 3759389, 878690, 1010892, 6793218, 4240732, 6442049, 5107899, 3641980, 7490142, 1525246, 4771678, 7559415, 8254960, 2104462, 2428441, 5580705, 2381016, 5754207, 236682, 8126825, 5452205, 7646718, 2979912, 3839019, 8115818, 4434445, 8315175, 7956613, 5044182, 3807539, 4880135, 1145539, 309958, 6738657, 831617, 2563169, 6088254, 2365237, 5660830, 6346319, 6528143, 1129058, 4714073, 2684003, 1334944, 7785832, 7055805, 1340604, 2569456, 8123434, 3670493, 4933504, 26078, 3254675, 4165336, 283978, 3154659, 1302943, 2227060, 1562819, 2514168, 44971, 6254553, 2944033, 4324887, 1291457, 5257504, 5534039, 8213325, 3065108, 7203031, 1096484, 4216030, 5469288, 393242, 2521825, 6300117, 8095172, 607439, 2634235, 6053337, 3001111, 5831767, 3027348, 4495957, 3587239, 7354050, 4507592, 5746646, 5667292, 2309711, 8111211, 950950, 4949517, 678266, 6305365, 2600760, 3616471, 5644106, 4210978, 6040112, 6687188, 467066, 5239657, 3201155, 7087275, 6742109, 7952128, 6508510, 4350070, 5148817, 4950968, 1716172, 228844, 2736887, 2498905, 8284068, 4768054, 3566891, 7456079, 6882872, 6785613, 837935, 1523304, 8091204, 2044376, 4959713, 3903156, 7410115, 3030563, 2166890, 6375901, 6277171, 8148082, 687866, 2942035, 8052202, 3022532, 3325824, 3311977, 5886484, 7107456, 1563179, 848378, 6414999, 7098106, 1601329, 751493, 5830719, 2513141, 4867973, 1230544, 8316097, 7870888, 1813964, 1410523, 6257787, 5349934, 4096225, 6325092, 3863955, 4105783, 4836516, 6615383, 23259, 5499798, 2662634, 7865271, 2522613, 7847525, 2262901, 4011354, 4267137, 3779276, 7735185, 687000, 7143736, 5392398, 7566548, 7750973, 6550827, 4055981, 6072486, 7846855, 2697184, 526773, 4967635, 5944034, 1616316, 6329605, 2487041, 1089110, 6137801, 7749148, 1181972, 4411686, 7977116, 5812113, 924455, 3621653, 185432, 465178, 7421635, 687633, 5608711, 7249490, 3820641, 6243334, 7930900, 6488578, 1954293, 3264921, 6221385, 4100951, 2594908, 5589882, 7852809, 5964050, 7617579, 774652, 5169008, 957993, 3794762, 65077, 1786027, 157832, 4381348, 1618702, 5889616, 5747175, 7553213, 5359458, 6458418, 7978098, 7093390, 1559021, 5734444, 1447023, 5539270, 7168886, 2054188, 6086927, 6345138, 6165199, 3046070, 1894513, 7977202, 1064611, 4554728, 61403, 7755078, 3890219, 4518826, 8305162, 5461305, 8054961, 4993683, 4340432, 3970546, 6358891, 194763, 5351191, 177363, 2897197, 4117304, 4478502, 4438421, 7048672, 8119303, 1370731, 3522249, 263488, 5423805, 5451716, 3520839, 4576482, 1529102, 7213499, 3972439, 4818365, 7617103, 6359928, 3135797, 8308566, 7359155, 4096569, 8358104, 6920155, 7701610, 865712, 87684, 8044677, 3117217, 4945612, 3565977, 1021189, 2688860, 7408770, 1284505, 4640129, 965031, 8176229, 8237700, 2662113, 4078411, 5133260, 7479052, 1018916, 5555328, 7284358, 7771213, 6530887, 5591981, 2614766, 7234800, 7123815, 464816, 6417931, 915036, 2375076, 7037045, 4832165, 2750474, 6936430, 4725014, 3352519, 1730356, 2089055, 4567768, 594744, 3219843, 5011586, 4696316, 7838897, 1238142, 1255843, 3296949, 4970007, 3883791, 4425690, 4935526, 2738903, 5328208, 5594472, 7056875, 7314976, 7907035, 4465090, 8013941, 384675, 5552799, 7346799, 7807100, 1216861, 6685063, 1486814, 3152996, 194139, 7285049, 3595761, 6119205, 6642011, 4260579, 4059919, 2051319, 5328355, 110587, 669327, 5823245, 16684, 3814943, 4520396, 2599061, 4737095, 6187358, 6564804, 7269306, 1323341, 6746819, 3170213, 8246629, 2150048, 367957, 4261361, 1260394, 2045954, 4810407, 5784148, 528444, 1465111, 1291419, 2639906, 986807, 2042834, 830308, 8213870, 460317, 2132458, 974354, 3682417, 1055481, 4504309, 4431093, 3147373, 512078, 3852532, 3446121, 7548269, 510934, 290163, 4136909, 7196174, 5123280, 6553772, 6236461, 7970674, 4074260, 4358916, 5630145, 947748, 3938358, 4154714, 7330445, 3075653, 5297385, 1737408, 2305961, 1972080, 4726011, 1614881, 3025737, 1460009, 7746607, 2000731, 3908368, 3149511, 2184928, 360595, 3003134, 1035504, 7204208, 7932151, 3163875, 6655193, 1614905, 6354168, 7823901, 5114745, 964448, 5089775, 6186695, 8002881, 1816467, 5980704, 5371184, 3885348, 7071367, 6644889, 2455477, 2885185, 6727259, 4109071, 331509, 3822010, 6848990, 5001710, 1980966, 2924315, 1814093, 5329050, 1024630, 7315596, 4166661, 6847224, 3093527, 6865872, 1506354, 8209507, 1628764, 6742491, 5768855, 5790303, 2405320, 1558736, 7594911, 6201441, 6591546, 4336562, 5421011, 5166131, 5190324, 8259105, 2153506, 7408888, 5587502, 3620294, 737659, 7579838, 4274616, 5593021, 6536977, 6316443, 5603139, 3558640, 7270997, 248548, 2859681, 6708, 6743694, 7174034, 7265499, 7538507, 4993398, 2031572, 3609466, 681982, 3816331, 7199104, 32605, 7084968, 6945336, 3873232, 3271430, 2569908, 3987907, 1762282, 6765057, 3849002, 5287944, 6215760, 7235526, 3238770, 4599651, 4603191, 2072540, 1692707, 5517871, 1923030, 244103, 4073759, 633401, 418298, 6035220, 7385128, 3031625, 7934987, 2275934, 3598377, 7150808, 1208180, 4661446, 1963078, 4574449, 4736619, 3097546, 423277, 2112190, 33939, 1816342, 2562993, 5346938, 7154052, 336613, 4266988, 4981956, 7432546, 5444284, 2556892, 6340170, 5307963, 2297439, 3245857, 396886, 128814, 4339345, 4965893, 4016279, 6843876, 823032, 5953889, 3367866, 5613265, 6178639, 7411576, 6019913, 5181664, 120187, 7573210, 6290635, 2377626, 3926986, 2491009, 4530752, 2858091, 6298969, 8198728, 3083157, 4042563, 5851310, 3957157, 5493913, 506760, 6727936, 7367552, 6440990, 311795, 6431517, 143572, 3812002, 1602020, 5492539, 4788657, 6788391, 1733300, 1469608, 2263977, 4165369, 291809, 8107972, 4568221, 3444176, 898205, 6151148, 2768530, 7363680, 5023239, 2415669, 7022713, 4447028, 4873648, 5730474, 294867, 6436448, 693126, 6244238, 4448436, 7235500, 1730729, 7343100, 562886, 2858333, 7412302, 1127506, 5003954, 1562506, 6024506, 4679568, 6679554, 940530, 7632738, 6858383, 6300739, 7980904, 6317921, 1760556, 6414384, 5439645, 6014980, 6772053, 789391, 3928052, 5347146, 3526531, 5011825, 3421220, 3535130, 1694553, 2469048, 5289593, 5368839, 2041467, 4795564, 5391778, 4839340,
		2220122, 3235076, 4305555, 732578, 3740453, 4627781, 5770467, 3967422, 949193, 569912, 1947434, 8177767, 2190073, 560929, 3316242, 395226, 3663223, 4082431, 6847178, 8187862, 4137487, 4787316, 3540910, 6269973, 3746314, 4544761, 4396628, 4033862, 1979517, 2382471, 4535086, 4814445, 1304196, 4373017, 4790664, 4937873, 2004091, 2986924, 5073182, 2383368, 3436163, 2593365, 3151132, 4766713, 8278180, 3170408, 5514287, 7873503, 3164905, 6179311, 7412975, 7955415, 5575726, 7537877, 6185457, 5967541, 844076, 4433567, 7402709, 1937632, 7132475, 6194001, 3339874, 169943, 3114191, 6852553, 7024584, 7341380, 1940785, 5942148, 6904118, 6911249, 3851126, 2163677, 4256665, 7205185, 6486722, 1645509, 8332714, 6034165, 4892743, 2760650, 6660217, 3090334, 6896459, 4505701, 7620242, 8098515, 1655958, 171488, 3449104, 5967287, 7475118, 4686393, 5843816, 5264437, 4999136, 4239378, 3999014, 6355916, 5913300, 2541798, 8304985, 4377535, 100472, 3464140, 2386903, 6911289, 1054468, 1413426, 2670247, 8110020, 5042228, 381920, 821569, 2735930, 2835085, 2111788, 3263179, 3367763, 6612197, 2478526, 4314283, 5675122, 5635567, 4992569, 5639297, 3176535, 5410114, 4643197, 337773, 3579864, 3784933, 4952956, 8245892, 422552, 5595693, 656130, 729987, 4855061, 4251091, 6905395, 7689900, 5530345, 7576057, 1617575, 3668581, 7092462, 5160548, 676611, 7451551, 3051878, 3505919, 4984025, 2957449, 4786919, 3027668, 1121309, 3113151, 2417246, 4317056, 7128252, 6941130, 3468275, 5919969, 1220708, 8227062, 5780406, 2338957, 8138006, 7524259, 4397586, 3486980, 4553495, 3811888, 7915085, 5580669, 4426411, 1711862, 286663, 4132632, 6575426, 3677828, 8241758, 4381762, 1800245, 137520, 7937580, 6666588, 3112361, 272887, 1002203, 4774297, 4833041, 6351982, 8199606, 1127565, 8097800, 5137763, 3779106, 6032837, 5488865, 6783711, 3472024, 5562308, 2302715, 3581739, 5949861, 7295640, 2663485, 7192873, 4904912, 8346757, 7183481, 7173690, 4188912, 3592224, 5333102, 4732014, 4152951, 6886254, 4791298, 516573, 3403120, 740578, 3512832, 522993, 7118788, 5255859, 343061, 7648302, 467433, 6412857, 3527347, 6462973, 3421216, 8377523, 1308455, 5830670, 280714, 1959533, 5294897, 3802782, 2459270, 1870817, 5028470, 4260666, 304781, 4556809, 3617566, 1392288, 4781293, 5843827, 6301656, 2893538, 1430741, 1856134, 2701599, 731401, 8063693, 2179950, 7446530, 1362692, 6105087, 4079464, 1611999, 7722446, 5485628, 6678181, 3058764, 1156967, 982998, 5039141, 2133024, 5352388, 5144329, 5350071, 2449736, 4137029, 7585966, 5685661, 2810534, 6034527, 2332235, 704800, 767659, 1548776, 4852402, 8123980, 3267936, 7413434, 2826547, 5414299, 2065595, 7226940, 2019228, 4456107, 296040, 6212709, 5925633, 1290774, 1598253, 2182754, 3783979, 1926084, 750331, 1015382, 6384466, 1439520, 4461576, 5017802, 6979531, 5686475, 3025711, 2944230, 353489, 2936679, 2881372, 253197, 8063051, 7693275, 2352961, 4670305, 2867654, 6526041, 2643117, 5688606, 37134, 909621, 5110325, 1076548, 6661473, 2430774, 3613603, 3587724, 3547595, 6255396, 129747, 3062799, 2099671, 3801965, 4580345, 380231, 492996, 2699940, 785268, 7810812, 4505446, 7315787, 2922596, 5244377, 2846749, 5549487, 5400571, 2314251, 927600, 2109650, 3888417, 5504416, 5927864, 2314762, 1221267, 5893651, 17802, 6857036, 7725762, 57848, 6746699, 4161939, 5123457, 5021260, 1193794, 2512643, 5581263, 7190788, 7960561, 1170649, 6967055, 664621, 6094034, 1101682, 6804948, 3204419, 4511450, 6160588, 250780, 7732526, 8366185, 4268214, 2702202, 6240983, 6036127, 3341571, 2921208, 2129397, 5680527, 5879217, 3920131, 987840, 2968598, 1814276, 6164395, 7999957, 3452942, 4409716, 7700372, 7257661, 1317060, 4519728, 425180, 6408607, 4545130, 6855327, 3156592, 1659492, 5226861, 5711495, 3696253, 1447684, 3330876, 3755787, 2565811, 7433159, 5559942, 2749411, 4296667, 5306034, 2441153, 581235, 6299927, 2542828, 7756408, 564594, 4412832, 2583075, 5255461, 3015363, 2038159, 3070026, 5708827, 591256, 5549919, 4196963, 1905423, 3963322, 5682374, 3743318, 1453588,
		7393917, 7499749, 622744, 1252738, 3022083, 6594304, 6103452, 3894986, 4739129, 266048, 6785598, 855344, 3767654, 3513420, 8072657, 2346335, 484641, 5958168, 5020039, 2454081, 8242966, 7407374, 6166750, 3230944, 290977, 3117802, 6374984, 5371960, 1665609, 1682853, 879392, 6603617, 7497618, 3975077, 2637172, 7779754, 5356420, 3009975, 7738251, 5702186, 3482807, 2743433, 2681456, 7551810, 3546998, 3081592, 2364684, 5209707, 6149920, 7140824, 7608277, 3232704, 6871664, 7373490, 627734, 374575,
		5421931, 3844435, 5940840, 1235541, 5732497, 2673767, 7530938};

#elif NIMS_TRI_NTT_MODE == 55
//Q = 8404993
//zeta = 4184677 //(2^8*3^3)th root of unity
//invMONT = 7896129
//invzeta = 1554873
//W = 6999551
#define MONT 15873 // 2^32 % Q
#define Wmont	6675549 //mont * W (W : 3rd root of unity)
#define W2mont	1713571 //mont * W^2
#define	F1	6642923 //mont^2/N
#define F2	4880853 //2 * mont^2/N

#define radix3_len 3 //radix-3 2번
#define radix2_redlen_ntt (N>>8)
#define radix2_redlen_invntt (N>>3)

int32_t merging_zetas[] = {6691422, 3745396, 1005959, 5560684, 557530, 1359546, 5166674, 5884035, 6365869, 2241533, 2021449, 3517630, 7346728, 4905548, 4422884, 6130832, 3005748, 5238671, 3440514, 4703105, 940539, 4240425, 2818295, 1059740, 2892723, 6587485, 4244468, 3541424, 5387571, 1575156, 6639601, 3284715, 964913, 106719, 2439163, 1046739, 1563110, 7206912, 2652420, 2954142, 8379323, 7950516, 2694230, 1200488, 285221, 8059860, 1193423, 7129183, 7731829, 3252563, 8040721, 2282474, 264713, 8060094, 445982, 8011185, 6563702, 6468071, 4739225, 1369059, 7955478, 5679661, 6136964, 5113226, 7951916, 2149249, 3683432, 4851479, 6738222, 7938303, 7925831, 1335443, 6949595, 8252838, 2533493, 5152479, 351317, 69907, 1033092, 2530659, 67928, 1728878, 4628830, 6097080, 8278066, 6520199, 7059579, 3908887, 3741732, 5872664, 4478964, 1844725, 3046182, 1661123, 6710463, 1533306, 751008, 777419, 8184245, 3037667, 87056, 7368142, 1719154, 4291236, 613216, 4320384, 4955376, 1690952, 7339862, 4474239, 6784644, 4426392, 2909821, 7943851, 7097598, 948115, 3618608, 7116055, 3420707, 4466850, 3331941, 8249857, 4873863, 1686410, 2031465, 2812877, 6321919, 7672067, 1196093, 1086929, 1679678, 6892943, 6201985, 280851, 4838437, 1269346, 286108, 2180160, 4028114, 5946783, 3280475, 1093944, 2953005, 5294676, 3364626, 1176, 5818203, 7532885, 7589923, 6465761, 7083882, 5542137, 6290777, 6208581, 4603252, 7727308, 6588778, 625905, 6148742, 2989190, 4934225, 8349238, 4018245, 6933212, 7729342, 905487, 3845758, 1099113, 7903618, 6380048, 1313510, 6818581, 1844170, 4995993, 2510402, 8090989, 460717, 3495458, 2321474, 6689731, 8269219, 6053013, 577288, 5100927, 3209389, 3044372, 4821549, 2313948, 1145465, 7197271, 7998760, 2770361, 7365006, 5631248, 2577595, 7566618, 7779883, 3552194, 5426137, 226028, 4944063, 1390757, 4270717, 4051664, 4282185, 4953682, 4416567, 3438679, 1351657, 806825, 4615431, 574573, 304984, 4943292, 6607630, 5841098, 483603, 6844990, 5184478, 8193371, 5421164, 4815963, 1190228, 7879235, 7430274, 2472636, 6207605, 3475370, 7326792, 459765, 7611163, 4641031, 7678294, 5352327, 6575361, 7606168, 278548, 6820008, 675466, 7583149, 586507, 70338, 6948390, 8339833, 4509876, 7342567, 1302054, 3044034, 3566248, 7839232, 4994119, 2649626, 2038881, 7118134, 2661184 };
int32_t merging_zetas_radix3[] = {5187630, 5567006, 7123335, 2138750, 1307768, 1405381, 56522, 5496949, 3283020, 3077132, 2803881, 3273713, 3841362, 5379076, 4698559, 276591, 7100721, 239145, 2124750, 8128402, 1573250, 365669, 926563, 6266243, 7205603, 2837987, 2965391, 7517826, 7603213, 1681972, 8265246, 5131280, 6533880, 5628597, 1076883, 2510840, 7454905, 719370, 6838166, 2017962, 1525979, 3521817, 6883480, 4528273, 8379093, 4724763, 8200884, 3796430, 7068951, 745421, 6258932, 4608563, 3043161, 6546235, 197274, 5894153, 2338364, 2776396, 1661017, 7235603, 5164872, 4515800, 6713958, 3876720, 433795, 5317839, 3053345, 3284897, 1708002, 2889477, 5987846, 7928632, 8103639, 7215594, 3776738, 2437214, 7405893, 4370531, 3581890, 6109011, 1761601, 4128440, 2887591, 2295982, 2836279, 1960853, 4883958, 5120096, 7301990, 3087154, 5661133, 7655428, 3682426, 593495, 4831078, 5967779, 1918808, 3078610, 5928489, 3218336, 4579567, 6368024, 4815956, 90881, 4189694, 6955843, 5969652, 5609893, 5417020, 4423403, 5480542, 309582, 4221177, 1629460, 1978525, 8095411, 1207855, 5700774, 37923, 5186657, 7060028, 5326383, 2516353, 7641739, 7729595, 6677606, 4307141, 2795100, 6623753, 5696947, 220591, 640958, 2490308, 964338, 6124052, 1289973, 561790, 2226114, 1289222, 7143007, 7341160, 1046318, 1004253, 803840, 1845714, 7923061, 4968594, 7601153, 6826739, 27987, 965528, 7764035, 7669702, 2708046, 7483526, 1687276, 4184278, 1768178, 6392363, 1261986, 1693494, 5397589, 1195165, 4141818, 3173353, 4012934, 4080321, 2597113, 3206900, 3797749, 3427919, 2351765, 3958285, 3053419, 6236896, 6036004, 2675293, 790345, 6565165, 2368989, 3435061, 4948878, 1630666, 4263175, 7149337, 3007404, 233076, 7195237, 7227670, 1643945, 1982341, 6053228, 2084479, 3675838, 1385379, 3849778, 6300791, 5455581, 7245500, 2815114, 6894862, 2267012, 1906899, 2685377, 7016262, 7311930, 1356060, 2622406, 1037511, 5942850, 4575684, 5782587, 4616282, 5500491, 1731939, 4555215, 4928233, 4729155, 3409280, 2756715, 7967488, 8077987, 2966254, 5719616, 3877418, 1560352, 3542387, 6821894, 8143183, 833038, 6448849, 1482126, 4245121, 4513011, 1059673, 6017397, 6030946, 887784, 4724656, 3717125, 4840800, 6073363, 308157, 4687868, 6698800, 7499523, 2685500, 1583099, 4816015, 6844641, 1954392, 7709678, 4402060, 4550163, 688220, 2387596, 3496258, 7711960, 4775139, 6917896, 82329, 2884498, 2051694, 826626, 1502833, 5071781, 2350266, 2319634, 654376, 997529, 2986542, 2445560, 1065441, 4378748, 1535266, 5959433, 4324123, 3146260, 3929613, 1487097, 2278413, 693033, 6303576, 7915425, 4020654, 5330058, 6080344, 6085359, 3998155, 3138798, 5801151, 335479, 6137798, 8199468, 2134627, 7769572, 3918781, 4062299, 7833721, 590575, 3947129, 7020596, 316758, 7477612, 5597631, 7201097, 1458408, 927381, 198719, 8360147, 3887307, 8069514, 577673, 5266195, 4594806, 7356075, 2434996, 7272087, 1682318, 7814418, 6348454, 7651632, 286150, 5212041, 7950325, 6516880, 7445307, 3827543, 1615887, 3007373, 8240463, 5431617, 3567907, 7437147, 2645777, 515993, 7290967, 2254012, 5147067, 7889000, 6205316, 854167, 1487418, 3192952, 7314433, 753361, 6679782, 4244195, 1118784, 7032873, 122290, 2973376, 2928390, 4116231, 8403952, 5342346, 3734452, 6813007, 4020, 7770593, 1957313, 7537819, 1721544, 6697026, 595299, 7709814, 4760469, 1231240, 1910632, 3249057, 7456006, 7173753, 2234481, 6062626, 7564399, 3062647, 5449879, 4288762, 8108525, 4647167, 7329055, 8044247, 1968406, 1707967, 5471251, 4682175, 6792039, 2905847, 4975695, 6315216, 7754677, 7294932, 5899177, 4178133, 2734127, 1153766, 1020684, 3489312, 874428, 2802528, 7561898, 455315, 923239, 5602465, 8247009, 43705, 2030009, 5499146, 1176741, 3722818, 1845114, 6395159, 4875941, 712751, 2490863, 7251227, 6347835, 5794072, 6904101, 436055, 1151372, 5049782, 8218140, 2008432, 5869587, 4163177, 2952259, 8234385, 5655169, 53285, 2672259, 375556, 7736376, 1552256, 1275616, 8029437, 4695563, 1837824, 7596703, 7968938, 6717711, 2610921, 5734707, 489340, 7195223, 5425338, 3190534, 170608, 3017256, 2194791, 2560193, 2134780, 182827, 2002037, 8304009, 1255109, 4233387, 6193357, 7961863, 552180, 2508166, 4068464, 4884289, 1026249, 4377683, 8388148, 1308532, 7378744, 3556943, 1807289, 4030085, 6270213, 5777692, 6210202, 1584807, 6203244, 6780739, 3028286, 6184712, 7852813, 432750, 7666377, 4882442, 1459264, 3706138, 3762892, 7595908, 704511, 5915709, 6477821, 6272386, 6848979, 3408152, 8237228, 775088, 4402245, 1019926, 5739205, 3798532, 4002748, 4617399, 7553490, 7542783, 6945729, 523805, 738616, 3718955, 1291499, 3601184, 8165137, 4822348, 1556014, 7006888, 7147319, 2868962, 5762218, 8101442, 1558317, 256852, 2120844, 1205793, 1024022, 4544227, 8014656, 4089620, 8119927, 2386297, 6889861, 4810963, 8171341, 1061026, 1515132, 7862474, 1730507, 1061927, 2642775, 6449055, 1257674, 2199724, 5477152, 4415594, 43185, 2695898, 390337, 4099298, 8043782, 1220102, 579728, 98416, 2460326, 5316226, 1011326, 7046327, 7938055, 3559563, 7468522, 5296878, 5941644, 3088345, 2246080, 6603656, 7576844, 861518, 6158913, 5739839, 74855, 4569434, 7825265, 4933087, 361211, 4218374, 6521372, 2167149, 4706406, 6357485, 936471, 4164473, 2064455, 1114166, 3601159, 64479, 7214988, 4296225, 2003667, 5042866, 7464427, 6920201, 1682448, 6048652, 6122539, 1204287, 7070112, 5085005, 1123889, 2339278, 1334881, 7429373, 3686115, 2423427, 4803834, 6985765, 6340538, 5561365, 1318705, 5065261, 5880107, 2600386, 6722545, 5398894, 8059407, 2960884, 137000, 4676572, 8287716, 1016086, 913101, 7383307, 1748521, 8009340, 1631329, 6289421, 4430637, 8067790, 4108704, 3983219, 1402935, 7130109, 4296289, 3190779, 2544430, 7418037, 8267993, 8318036, 345586, 200210, 4567637, 6241097, 3991427, 7171632, 6773664, 4994580, 6214078, 2585818, 2780826, 7873001, 5368915, 3627118, 1841808, 2089037, 1153908, 76719, 7948167, 3477546, 6874929, 406171, 1500222, 7662488, 7367986, 6550595, 6904771, 5789815, 1384982, 2825359, 5624167, 8253804, 2190915, 6500772, 1250762, 1535099, 6869137, 159577, 456826, 1600644, 3489556, 4767061, 1325706, 2521994, 4302871, 1792226, 5692079, 2482432, 3686699, 2556701, 459446, 7066224, 7551195, 6258634, 7269476, 2246699, 7176255, 1292506, 1135517, 7953767, 6151525, 2687103, 7079287, 1690967, 4915437, 2339794, 471908, 4996965, 3167354, 6393823, 7945547, 5879116, 7244355, 6769323, 5942610, 1229586, 4010547, 6146867, 1952340, 4633305, 1970528, 1400157, 4667160, 4855026, 5835515, 6413332, 7233851, 1979224, 809890, 4945626, 1171142, 5050410, 6619500, 3282636, 2462383, 305524, 1160638, 3417454, 3373132, 775053, 2839405, 5332655, 3737833, 6986220, 7904390, 5473969, 3830427, 5398103, 1267257, 8194029, 5109907, 1204573, 3327482, 5271973, 1320158, 1777361, 5462724, 1223069, 3829071, 7394476, 2826879, 5945015, 4575922, 4145792, 6430065, 5575682, 4574566, 5140808, 500603, 3297810, 888158, 2094713, 5096328, 2888055, 7084835, 2443041, 6362966, 3398406, 5362736, 3845450, 6225608, 5430434, 5315668, 7324321, 6816133, 6128178, 4076601, 4220099, 3368571, 290431, 1234152, 6911327, 4774106, 4284267, 7170841, 7551265, 987276, 6078806, 3042257, 3170047, 2042027, 2837528, 326314, 2058495, 7459760, 1153340, 4328392, 8043159, 338314, 6887926, 1116437, 3644378, 5546993, 190494, 5514068, 642322, 6559208, 4026319, 7928226, 3157279, 7073044, 2448537, 7081300, 8171543, 6897522, 8233115, 1323693, 5237729, 5037301, 4224353, 7288556, 2894702, 8066679, 6198651, 8189481, 4889378, 4223300, 720722, 476767, 3150419, 8072119, 4142954, 457268, 2143940, 5452302, 7932492, 454032, 5472635, 4784935, 5746488, 8119552, 7562931, 7327303, 407967, 5130560, 5548711, 4452061, 4955017, 3274433, 7823426, 168591, 5305231, 7947725, 1908653, 332874, 7506900, 7784571, 6522625, 2177869, 6156769, 285441, 7898754, 3952911, 769120, 4666753, 8215964, 5570646, 2818941, 2734099, 6388949, 3966429, 4931505, 3322933, 4962817, 2427710, 4088045, 5908989, 3887702, 7919340, 374951, 2496004, 7575010, 6057032, 4583311, 3738240, 7277837, 4452082, 7953248, 7094463, 4742723, 3074642, 5183998, 5082060, 7987800, 2124377, 3410505, 5145337, 2127721, 815886, 4899274, 3268115, 7835433, 193770, 6223732, 7454054, 3090279, 6748393, 914530, 4338385, 1174089, 2318147, 1967591, 4066608, 6360043, 2317176, 2235894, 3259656, 5837469, 6280616, 2577273, 3488737, 2089292, 5154271, 2836572, 950939, 6712164, 8120925, 2219476, 6469601, 5714851, 2363031, 1238975, 2888804, 3534051, 3930556, 3077175, 3308921, 2483174, 6938646, 1051446, 3894353, 6201675, 3646488, 5300985, 4510640, 6206544, 6197725, 4429432, 1935392, 7097227, 284068, 413620, 5003254, 6160780, 6257384, 5669300, 5096072, 6346292, 5669951, 4974429, 5812317, 40015, 7129659, 7943119, 1218973, 5976856, 3399944, 5706061, 4908903, 6709211, 5507530, 7491541, 1185413, 6198884, 664902, 7407794, 7219580, 7000082, 6127876, 3221086, 2592676, 4551327, 2735042, 2650310, 2914854, 5396981, 8315072, 1755205, 3496090, 4637472, 1278047, 4019854, 5872648, 6463460, 8228884, 5283241, 8285746, 561663, 1717263, 6996581, 937493, 569126, 3355612, 3888624, 751314, 8129046, 2995310, 7111435, 7653679, 2804122, 818246, 490026, 2532345, 4040621, 7126946, 6400065, 823267, 2653192, 575205, 5949954, 7467500, 3955830, 6139634, 4419272, 609825, 2363371, 1375226, 7616321, 2682550, 7073645, 2525292, 913830, 5284484, 3213265, 278546, 7492045, 3405395, 7850887, 259933, 7315705, 4999598, 6260406, 7967034, 3261819, 7795168, 7069324, 2265359, 4111973, 888371, 2566023, 4780621, 1173116, 3120509, 4581463, 5065177, 3553115, 2259373, 2333198, 7213042, 255063, 7097777, 5147187, 6452941, 3301396, 7242635, 7017340, 5457520, 2268660, 2032526, 227895, 3113125, 1125823, 6372467, 1668269, 5935419, 8247820, 6145620, 4496549, 3339816, 2490560, 7716893, 4154272, 840575, 3195651, 1162358, 167912, 6830473, 343384, 3658352, 1637781, 1955976, 3348787, 6035139, 4984262, 4765821, 7183623, 7030454, 340723, 1626292, 3626545, 1834125, 4600007, 3191301, 982111, 6570868, 5940881, 4660600, 6041494, 4746641, 6532576, 1574520, 1736951, 5284644, 2504481, 3790101, 4337644, 1374539, 5328189, 5677633, 6950031, 7609615, 3950454, 310194, 6078801, 376555, 6856973, 7210505, 4215311, 5451510, 4096279, 1983069, 6635754, 7311162, 7770178, 4483145, 2961805, 1093831, 2680586, 5828065, 479648, 795378, 5021465, 2727360, 3385844, 1187691, 6247182, 7621356, 6568929, 2953483, 6938462, 2034494, 2112047, 8297137, 3075932, 7271297, 6062213, 5710165, 8386746, 6897259, 6193997, 2566540, 310111, 1303597, 8368587, 1045629, 8003572, 526760, 1081993, 7359364, 2066004, 8276705, 2894488, 107856, 5186522, 6370499, 1581710, 1195741, 4439605, 8316926, 988967, 5838453, 2916807, 8028648, 6865201, 6897144, 7172898, 5507933, 6527496, 311869, 708975, 4860000, 793704, 1499272, 2830604, 1404203, 6551063, 2231544, 767639, 4483655, 2510101, 6173449, 4167752, 1811141, 6826138, 1507849, 1982674, 376345, 4668027, 8301347, 3637370, 7739477, 2537991, 6905721, 4471806, 5028201, 637742, 2067583, 6665935, 977770, 1824523, 8214005, 7639276, 6004614, 7154775, 7895733, 8104291, 7053190, 5070150, 521174, 5565476, 2627822, 1452296, 7883819, 5815323, 7704745, 4225794, 6337410, 7290660, 3376792, 5837260, 715780, 2587542, 1498944, 5870687, 509260, 2905059, 3212995, 978845, 1071332, 7589002, 5042961, 5279006, 4384295, 4423591, 5230376, 5684755, 7885928, 3548609, 672255, 7937146, 5203418, 4373588, 38378, 6386271, 3201575, 1610526, 3865230, 1061958, 7333661, 3638382, 5191998, 3743461, 1743587, 5229322, 1841386, 7367899, 519065, 834406, 4282023, 8096703, 2930807, 1811911, 7793251, 3588481, 1466137, 6650272, 8118694, 2673938, 967537, 6016740, 6097774, 2366396, 4356008, 8282850, 3995724, 611502, 4048985, 5784151, 2433674, 5874020, 5474186, 1203031, 4122970, 167415, 623588, 5766847, 3744266, 1049030, 7437456, 7078619, 6234113, 2723088, 5629000, 1390285, 6408478, 505285, 2792843, 5408457, 8254981, 2497407, 2302798, 6800798, 263222, 4016976, 4336559, 1752194, 6084101, 6072751, 4068434, 2144811, 5095641, 8061699, 2775993, 7231488, 2170880, 412224, 5892222, 7333617, 2340044, 3397834, 6102195, 6269352, 4882749, 6552967, 8359348, 1123779, 5505080, 5504828, 5724366, 1967458, 4114652, 4467406, 7780799, 4611268, 4493514, 2368070, 2775909, 7330106, 592408, 7810093, 5629084, 3327370, 5100172, 8110560, 45645, 2033326, 3522244, 2920976, 4447869, 1767232, 8280989, 6620121, 624194, 2254675, 2167372, 3274096, 4338428, 7483684, 3617019, 7218460, 7541292, 4154213, 5114650, 6133565, 1911891, 1318, 1651667, 5840661, 5853855, 7700925, 7282022, 1801241, 2551138, 8278041, 1048190, 8013322, 4066565, 6208098, 6237621, 5737960, 5990095, 3914354, 1065881, 2354428, 6493102, 3410547, 2670958, 7540957, 2263243, 5804160, 3371040, 5831477, 4203909, 2896708, 3445189, 1568611, 5809561, 6636229, 4427451, 2686639, 899497, 3049450, 6116147, 4318191, 7505496, 6938518, 1608477, 3622502, 6141750, 1543152, 5734035, 1211043, 6690694, 5403300, 4270537, 5326987, 2595432, 7172708, 1899663, 1147738, 1430521, 5671898, 7773611, 2519493, 1178652, 4625077, 5075383, 2944985, 2585148, 8214102, 2055283, 4298993, 5239876, 3502520, 6975046, 6057592, 3165117, 6168458, 3763800, 3421193, 6974472, 658962, 6505330, 1961831, 3485804, 5756481, 4608494, 1894809, 5819845, 133956, 4890573, 983744, 4776312, 914324, 5995331, 6422738, 3564737, 4588604, 1667288, 8168042, 4521556, 1982417, 3079392, 2537893, 7946121, 7484634, 6557861, 7582299, 458872, 3908318, 8086293, 706342, 3628681, 7065598, 3514420, 584941, 7855704, 6611016, 5536459, 4717052, 3883437, 2181784, 7277985, 7919056, 2531920, 5315714, 7395871, 7011568, 3412460, 8099460, 6636700, 2160136, 4519158, 8077002, 5607728, 6918050, 3923104, 7724559, 5509692, 2745579, 4481889, 2092273, 7931618, 7418556, 5873073, 6547840, 1127008, 6795210, 8139648, 8205940, 2913982, 4593587, 3885835, 5162778, 4174789, 5081858, 5335292, 2678934, 3812512, 3119881, 2329536, 151844, 951646, 2589239, 3267107, 477281, 3805942, 174400, 2597126, 6272327, 5126435, 3221793, 5807867, 2735629, 5596643, 4756030, 3069701, 6466997, 4230204, 1482220, 736241, 7118156, 6409638, 6435538, 5137886, 62725, 1789817, 7527237, 4195569, 5650605, 6736213, 991639, 727916, 3684852, 4345891, 375157, 4052982, 8232807, 3217561, 174133, 2229075, 7359327, 6135708, 2420073, 6175918, 1726649, 4780898, 2983411, 4209424, 437663, 6615176, 3859759, 7413130, 3915096, 560295, 3091737, 4352011, 7613492, 5656764, 5601588, 1016095, 5512376, 3851399, 4697693, 2421586, 7133391, 3954033, 2918981, 4458901, 3353002, 4556661, 8274913, 6843551, 3588951, 1205804, 2555131, 1561442, 3195343, 6880487, 693664, 7388898, 4351720, 2748229, 976425, 5572756, 6226430, 2289957, 5748567, 3946092, 4046305, 6516893, 8396540, 353452, 5771123, 2631695, 177974, 5315041, 533274, 7460226, 7947821, 5389359, 3937664, 4015495, 5059624, 6535390, 6593856, 5572126, 5543522, 1869603, 8188964, 2299407, 7344113, 8051541, 2471360, 1888100, 6829268, 4368947, 7613071, 762092, 2451650, 3015634, 421707, 4616032, 7313662, 3207212, 1817568, 718839, 8065641, 82262, 2178601, 5105759, 1774201, 3708827, 7779373, 5273231, 2910037, 2041755, 1144927, 1316798, 7625955, 6363238, 6871858, 3791089, 2766170, 5197781, 157050, 3788961, 4009955, 75450, 7127620, 2760594, 1567076, 4696166, 3940319, 432545, 2289253, 1335315, 3019244, 5331527, 5305236, 1816635, 4317154, 7828807, 6129117, 5397411, 4484841, 1077775, 674355, 149482, 6574256, 8261352, 507868, 8255511, 697451, 7214046, 218750, 7069678, 5952899, 7972448, 2603546, 2413090, 7115744, 5481009, 6077734, 3007582, 264222, 6096395, 1500272, 3059070, 5029038, 2671562, 237691, 6953507, 968824, 4332540, 4467637, 6320697, 3972, 1775399, 2972725, 3462514, 3502978, 2023942, 5377306, 4942479, 1721847, 4869211, 5030915, 5345923, 4151445, 2308598, 903145, 4834469, 6018885, 6134076, 2810040, 2084296, 8019193, 2246053, 5872427, 4763944, 6800749, 7714402, 6267765, 4217036, 4634377, 8025549, 1188585, 6073933, 440987, 4060524, 5704375, 2219561, 894087, 1866609, 453984, 6185432, 7506945, 1885976, 3769452, 3641049, 1951098, 6158940, 3424947, 419475, 506665, 1528970, 895337, 2331060, 7327274, 5635671, 5045022, 3411882, 7375821, 8067023, 500835, 3581986, 6680549, 4531828, 1595299, 6973553, 4950070, 5939523, 64503, 5863331, 6150636, 1762506, 3673436, 2541662, 1992100, 2150546, 8364969, 4993111, 2785171, 2769322, 3207541, 946412, 3004946, 5525361, 8202130, 1431440, 7568212, 1720879, 2252566, 5330183, 1214956, 5939545, 965861, 7922106, 2894875, 8352176, 4816104, 376611, 1266753, 6345098, 997291, 1753836, 6841511, 1668062, 5406836, 6651157, 3969814, 8298717, 169391, 3074810, 5550621, 6684114, 6204090, 3270288, 7201589, 7693381, 4260335, 8028382, 8020815, 7345500, 3038166, 4397426, 3219729, 5666045, 4060268, 7573404, 2762178, 2186047, 2041022, 7025866, 317605, 7045489, 8225795, 4595967, 718176, 1126554, 4092037, 3809026, 3372081, 6194277, 692999, 4007567, 1613754, 1059493, 7716711, 3037922, 8291926, 1857019, 3675238, 1379127, 2943865, 4930522, 3686733, 3629313, 7853498, 5774063, 8386286, 180372, 4879722, 1018070, 7619603, 7615172, 7560401, 8015515, 2039821, 2545577, 7585393, 5948592, 7734185, 5859416, 848264, 7795544, 5279069, 4775680, 3557943, 3474471, 1772678, 3239835, 1406511, 8319640, 4417675, 789821, 2366377, 1687941, 3688063, 7957560, 6796318, 5264234, 4481427, 7090428, 2042885, 6099328, 3361268, 8393123, 4232317, 4769105, 5113633, 3576752, 5141860, 7787269, 7832421, 4828241, 367196, 7078558, 152225, 447433, 6906161, 6717052, 2716628, 4321672, 5324446, 435993, 2661757, 11870, 1150270, 4484909, 8222125, 1368093, 3356541, 312129, 7294528, 6860547, 4949529, 3000607, 3784661, 3736529, 2308834, 1266532, 8056564, 2593631, 6413093, 7485516, 8080628, 5811362, 54531, 2192083, 7211174, 7036900, 4884425, 3920084, 3364627, 2634625, 5859631, 2905760, 5027996, 4668464, 7998805, 2324488, 896483, 5094234, 1392640, 3677636, 2109110, 1784620, 6144348, 3665474, 870345, 2131325, 4916655, 8385734, 5770663, 5185189, 1022118, 5989962, 8353976, 3219804, 5478527, 3915945, 6325147, 3310759, 4429564, 6080505, 2353594, 5074975, 6793207, 457832, 381949, 6273668, 2654400, 5492721, 5626630, 3870484, 7220026, 2347886, 95719, 6435240, 3982608, 7918049, 5589833, 6133316, 5171, 4315644, 2272455, 7871167, 3861250, 5005777, 1282920, 533826, 5904510, 4163563, 1900577, 4534509, 314137, 2912272, 1939669, 8186128, 4350612, 1814060, 2464829, 2271677};

int32_t merging_zetas_inv[] = {5743809, 1286859, 6366112, 5755367, 3410874, 565761, 4838745, 5360959, 7102939, 1062426, 3895117, 65160, 1456603, 8334655, 7818486, 821844, 7729527, 1584985, 8126445, 798825, 1829632, 3052666, 726699, 3763962, 793830, 7945228, 1078201, 4929623, 2197388, 5932357, 974719, 525758, 7214765, 3589030, 2983829, 211622, 3220515, 1560003, 7921390, 2563895, 1797363, 3461701, 8100009, 7830420, 3789562, 7598168, 7053336, 4966314, 3988426, 3451311, 4122808, 4353329, 4134276, 7014236, 3460930, 8178965, 2978856, 4852799, 625110, 838375, 5827398, 2773745, 1039987, 5634632, 406233, 1207722, 7259528, 6091045, 3583444, 5360621, 5195604, 3304066, 7827705, 2351980, 135774, 1715262, 6083519, 4909535, 7944276, 314004, 5894591, 3409000, 6560823, 1586412, 7091483, 2024945, 501375, 7305880, 4559235, 7499506, 675651, 1471781, 4386748, 55755, 3470768, 5415803, 2256251, 7779088, 1816215, 677685, 3801741, 2196412, 2114216, 2862856, 1321111, 1939232, 815070, 872108, 2586790, 8403817, 5040367, 3110317, 5451988, 7311049, 5124518, 2458210, 4376879, 6224833, 8118885, 7135647, 3566556, 8124142, 2203008, 1512050, 6725315, 7318064, 7208900, 732926, 2083074, 5592116, 6373528, 6718583, 3531130, 155136, 5073052, 3938143, 4984286, 1288938, 4786385, 7456878, 1307395, 461142, 5495172, 3978601, 1620349, 3930754, 1065131, 6714041, 3449617, 4084609, 7791777, 4113757, 6685839, 1036851, 8317937, 5367326, 220748, 7627574, 7653985, 6871687, 1694530, 6743870, 5358811, 6560268, 3926029, 2532329, 4663261, 4496106, 1345414, 1884794, 126927, 2307913, 3776163, 6676115, 8337065, 5874334, 7371901, 8335086, 8053676, 3252514, 5871500, 152155, 1455398, 7069550, 479162, 466690, 1666771, 3553514, 4721561, 6255744, 453077, 3291767, 2268029, 2725332, 449515, 7035934, 3665768, 1936922, 1841291, 393808, 7959011, 344899, 8140280, 6122519, 364272, 5152430, 673164, 1275810, 7211570, 345133, 8119772, 7204505, 5710763, 454477, 25670, 5450851, 5752573, 1198081, 6841883, 7358254, 5965830, 8298274, 7440080, 5120278, 1765392, 6829837, 3017422, 4863569, 4160525, 1817508, 5512270, 7345253, 5586698, 4164568, 7464454, 3701888, 4964479, 3166322, 5399245, 2274161, 3982109, 3499445, 1058265, 4887363, 6383544, 6163460, 2039124, 2520958, 3238319, 7045447, 7847463, 2844309, 7399034, 4659597, 3949336};
int32_t merging_zetas_inv_radix3[] = {2464829, 2271677, 4350612, 1814060, 1939669, 8186128, 314137, 2912272, 1900577, 4534509, 5904510, 4163563, 1282920, 533826, 3861250, 5005777, 2272455, 7871167, 5171, 4315644, 5589833, 6133316, 3982608, 7918049, 95719, 6435240, 7220026, 2347886, 5626630, 3870484, 2654400, 5492721, 381949, 6273668, 6793207, 457832, 2353594, 5074975, 4429564, 6080505, 6325147, 3310759, 5478527, 3915945, 8353976, 3219804, 1022118, 5989962, 5770663, 5185189, 4916655, 8385734, 870345, 2131325, 6144348, 3665474, 2109110, 1784620, 1392640, 3677636, 896483, 5094234, 7998805, 2324488, 5027996, 4668464, 5859631, 2905760, 3364627, 2634625, 4884425, 3920084, 7211174, 7036900, 54531, 2192083, 8080628, 5811362, 6413093, 7485516, 8056564, 2593631, 2308834, 1266532, 3784661, 3736529, 4949529, 3000607, 7294528, 6860547, 3356541, 312129, 8222125, 1368093, 1150270, 4484909, 2661757, 11870, 5324446, 435993, 2716628, 4321672, 6906161, 6717052, 152225, 447433, 367196, 7078558, 7832421, 4828241, 5141860, 7787269, 5113633, 3576752, 4232317, 4769105, 3361268, 8393123, 2042885, 6099328, 4481427, 7090428, 6796318, 5264234, 3688063, 7957560, 2366377, 1687941, 4417675, 789821, 1406511, 8319640, 1772678, 3239835, 3557943, 3474471, 5279069, 4775680, 848264, 7795544, 7734185, 5859416, 7585393, 5948592, 2039821, 2545577, 7560401, 8015515, 7619603, 7615172, 4879722, 1018070, 8386286, 180372, 7853498, 5774063, 3686733, 3629313, 2943865, 4930522, 3675238, 1379127, 8291926, 1857019, 7716711, 3037922, 1613754, 1059493, 692999, 4007567, 3372081, 6194277, 4092037, 3809026, 718176, 1126554, 8225795, 4595967, 317605, 7045489, 2041022, 7025866, 2762178, 2186047, 4060268, 7573404, 3219729, 5666045, 3038166, 4397426, 8020815, 7345500, 4260335, 8028382, 7201589, 7693381, 6204090, 3270288, 5550621, 6684114, 169391, 3074810, 3969814, 8298717, 5406836, 6651157, 6841511, 1668062, 997291, 1753836, 1266753, 6345098, 4816104, 376611, 2894875, 8352176, 965861, 7922106, 1214956, 5939545, 2252566, 5330183, 7568212, 1720879, 8202130, 1431440, 3004946, 5525361, 3207541, 946412, 2785171, 2769322, 8364969, 4993111, 1992100, 2150546, 3673436, 2541662, 6150636, 1762506, 64503, 5863331, 4950070, 5939523, 1595299, 6973553, 6680549, 4531828, 500835, 3581986, 7375821, 8067023, 5045022, 3411882, 7327274, 5635671, 895337, 2331060, 506665, 1528970, 3424947, 419475, 1951098, 6158940, 3769452, 3641049, 7506945, 1885976, 453984, 6185432, 894087, 1866609, 5704375, 2219561, 440987, 4060524, 1188585, 6073933, 4634377, 8025549, 6267765, 4217036, 6800749, 7714402, 5872427, 4763944, 8019193, 2246053, 2810040, 2084296, 6018885, 6134076, 903145, 4834469, 4151445, 2308598, 5030915, 5345923, 1721847, 4869211, 5377306, 4942479, 3502978, 2023942, 2972725, 3462514, 3972, 1775399, 4467637, 6320697, 968824, 4332540, 237691, 6953507, 5029038, 2671562, 1500272, 3059070, 264222, 6096395, 6077734, 3007582, 7115744, 5481009, 2603546, 2413090, 5952899, 7972448, 218750, 7069678, 697451, 7214046, 507868, 8255511, 6574256, 8261352, 674355, 149482, 4484841, 1077775, 6129117, 5397411, 4317154, 7828807, 5305236, 1816635, 3019244, 5331527, 2289253, 1335315, 3940319, 432545, 1567076, 4696166, 7127620, 2760594, 4009955, 75450, 157050, 3788961, 2766170, 5197781, 6871858, 3791089, 7625955, 6363238, 1144927, 1316798, 2910037, 2041755, 7779373, 5273231, 1774201, 3708827, 2178601, 5105759, 8065641, 82262, 1817568, 718839, 7313662, 3207212, 421707, 4616032, 2451650, 3015634, 7613071, 762092, 6829268, 4368947, 2471360, 1888100, 7344113, 8051541, 8188964, 2299407, 5543522, 1869603, 6593856, 5572126, 5059624, 6535390, 3937664, 4015495, 7947821, 5389359, 533274, 7460226, 177974, 5315041, 5771123, 2631695, 8396540, 353452, 4046305, 6516893, 5748567, 3946092, 6226430, 2289957, 976425, 5572756, 4351720, 2748229, 693664, 7388898, 3195343, 6880487, 2555131, 1561442, 3588951, 1205804, 8274913, 6843551, 3353002, 4556661, 2918981, 4458901, 7133391, 3954033, 4697693, 2421586, 5512376, 3851399, 5601588, 1016095, 7613492, 5656764, 3091737, 4352011, 3915096, 560295, 3859759, 7413130, 437663, 6615176, 2983411, 4209424, 1726649, 4780898, 2420073, 6175918, 7359327, 6135708, 174133, 2229075, 8232807, 3217561, 375157, 4052982, 3684852, 4345891, 991639, 727916, 5650605, 6736213, 7527237, 4195569, 62725, 1789817, 6435538, 5137886, 7118156, 6409638, 1482220, 736241, 6466997, 4230204, 4756030, 3069701, 2735629, 5596643, 3221793, 5807867, 6272327, 5126435, 174400, 2597126, 477281, 3805942, 2589239, 3267107, 151844, 951646, 3119881, 2329536, 2678934, 3812512, 5081858, 5335292, 5162778, 4174789, 4593587, 3885835, 8205940, 2913982, 6795210, 8139648, 6547840, 1127008, 7418556, 5873073, 2092273, 7931618, 2745579, 4481889, 7724559, 5509692, 6918050, 3923104, 8077002, 5607728, 2160136, 4519158, 8099460, 6636700, 7011568, 3412460, 5315714, 7395871, 7919056, 2531920, 2181784, 7277985, 4717052, 3883437, 6611016, 5536459, 584941, 7855704, 7065598, 3514420, 706342, 3628681, 3908318, 8086293, 7582299, 458872, 7484634, 6557861, 2537893, 7946121, 1982417, 3079392, 8168042, 4521556, 4588604, 1667288, 6422738, 3564737, 914324, 5995331, 983744, 4776312, 133956, 4890573, 1894809, 5819845, 5756481, 4608494, 1961831, 3485804, 658962, 6505330, 3421193, 6974472, 6168458, 3763800, 6057592, 3165117, 3502520, 6975046, 4298993, 5239876, 8214102, 2055283, 2944985, 2585148, 4625077, 5075383, 2519493, 1178652, 5671898, 7773611, 1147738, 1430521, 7172708, 1899663, 5326987, 2595432, 5403300, 4270537, 1211043, 6690694, 1543152, 5734035, 3622502, 6141750, 6938518, 1608477, 4318191, 7505496, 3049450, 6116147, 2686639, 899497, 6636229, 4427451, 1568611, 5809561, 2896708, 3445189, 5831477, 4203909, 5804160, 3371040, 7540957, 2263243, 3410547, 2670958, 2354428, 6493102, 3914354, 1065881, 5737960, 5990095, 6208098, 6237621, 8013322, 4066565, 8278041, 1048190, 1801241, 2551138, 7700925, 7282022, 5840661, 5853855, 1318, 1651667, 6133565, 1911891, 4154213, 5114650, 7218460, 7541292, 7483684, 3617019, 3274096, 4338428, 2254675, 2167372, 6620121, 624194, 1767232, 8280989, 2920976, 4447869, 2033326, 3522244, 8110560, 45645, 3327370, 5100172, 7810093, 5629084, 7330106, 592408, 2368070, 2775909, 4611268, 4493514, 4467406, 7780799, 1967458, 4114652, 5504828, 5724366, 1123779, 5505080, 6552967, 8359348, 6269352, 4882749, 3397834, 6102195, 7333617, 2340044, 412224, 5892222, 7231488, 2170880, 8061699, 2775993, 2144811, 5095641, 6072751, 4068434, 1752194, 6084101, 4016976, 4336559, 6800798, 263222, 2497407, 2302798, 5408457, 8254981, 505285, 2792843, 1390285, 6408478, 2723088, 5629000, 7078619, 6234113, 1049030, 7437456, 5766847, 3744266, 167415, 623588, 1203031, 4122970, 5874020, 5474186, 5784151, 2433674, 611502, 4048985, 8282850, 3995724, 2366396, 4356008, 6016740, 6097774, 2673938, 967537, 6650272, 8118694, 3588481, 1466137, 1811911, 7793251, 8096703, 2930807, 834406, 4282023, 7367899, 519065, 5229322, 1841386, 3743461, 1743587, 3638382, 5191998, 1061958, 7333661, 1610526, 3865230, 6386271, 3201575, 4373588, 38378, 7937146, 5203418, 3548609, 672255, 5684755, 7885928, 4423591, 5230376, 5279006, 4384295, 7589002, 5042961, 978845, 1071332, 2905059, 3212995, 5870687, 509260, 2587542, 1498944, 5837260, 715780, 7290660, 3376792, 4225794, 6337410, 5815323, 7704745, 1452296, 7883819, 5565476, 2627822, 5070150, 521174, 8104291, 7053190, 7154775, 7895733, 7639276, 6004614, 1824523, 8214005, 6665935, 977770, 637742, 2067583, 4471806, 5028201, 2537991, 6905721, 3637370, 7739477, 4668027, 8301347, 1982674, 376345, 6826138, 1507849, 4167752, 1811141, 2510101, 6173449, 767639, 4483655, 6551063, 2231544, 2830604, 1404203, 793704, 1499272, 708975, 4860000, 6527496, 311869, 7172898, 5507933, 6865201, 6897144, 2916807, 8028648, 988967, 5838453, 4439605, 8316926, 1581710, 1195741, 5186522, 6370499, 2894488, 107856, 2066004, 8276705, 1081993, 7359364, 8003572, 526760, 8368587, 1045629, 310111, 1303597, 6193997, 2566540, 8386746, 6897259, 6062213, 5710165, 3075932, 7271297, 2112047, 8297137, 6938462, 2034494, 6568929, 2953483, 6247182, 7621356, 3385844, 1187691, 5021465, 2727360, 479648, 795378, 2680586, 5828065, 2961805, 1093831, 7770178, 4483145, 6635754, 7311162, 4096279, 1983069, 4215311, 5451510, 6856973, 7210505, 6078801, 376555, 3950454, 310194, 6950031, 7609615, 5328189, 5677633, 4337644, 1374539, 2504481, 3790101, 1736951, 5284644, 6532576, 1574520, 6041494, 4746641, 5940881, 4660600, 982111, 6570868, 4600007, 3191301, 3626545, 1834125, 340723, 1626292, 7183623, 7030454, 4984262, 4765821, 3348787, 6035139, 1637781, 1955976, 343384, 3658352, 167912, 6830473, 3195651, 1162358, 4154272, 840575, 2490560, 7716893, 4496549, 3339816, 8247820, 6145620, 1668269, 5935419, 1125823, 6372467, 227895, 3113125, 2268660, 2032526, 7017340, 5457520, 3301396, 7242635, 5147187, 6452941, 255063, 7097777, 2333198, 7213042, 3553115, 2259373, 4581463, 5065177, 1173116, 3120509, 2566023, 4780621, 4111973, 888371, 7069324, 2265359, 3261819, 7795168, 6260406, 7967034, 7315705, 4999598, 7850887, 259933, 7492045, 3405395, 3213265, 278546, 913830, 5284484, 7073645, 2525292, 7616321, 2682550, 2363371, 1375226, 4419272, 609825, 3955830, 6139634, 5949954, 7467500, 2653192, 575205, 6400065, 823267, 4040621, 7126946, 490026, 2532345, 2804122, 818246, 7111435, 7653679, 8129046, 2995310, 3888624, 751314, 569126, 3355612, 6996581, 937493, 561663, 1717263, 5283241, 8285746, 6463460, 8228884, 4019854, 5872648, 4637472, 1278047, 1755205, 3496090, 5396981, 8315072, 2650310, 2914854, 4551327, 2735042, 3221086, 2592676, 7000082, 6127876, 7407794, 7219580, 6198884, 664902, 7491541, 1185413, 6709211, 5507530, 5706061, 4908903, 5976856, 3399944, 7943119, 1218973, 40015, 7129659, 4974429, 5812317, 6346292, 5669951, 5669300, 5096072, 6160780, 6257384, 413620, 5003254, 7097227, 284068, 4429432, 1935392, 6206544, 6197725, 5300985, 4510640, 6201675, 3646488, 1051446, 3894353, 2483174, 6938646, 3077175, 3308921, 3534051, 3930556, 1238975, 2888804, 5714851, 2363031, 2219476, 6469601, 6712164, 8120925, 2836572, 950939, 2089292, 5154271, 2577273, 3488737, 5837469, 6280616, 2235894, 3259656, 6360043, 2317176, 1967591, 4066608, 1174089, 2318147, 914530, 4338385, 3090279, 6748393, 6223732, 7454054, 7835433, 193770, 4899274, 3268115, 2127721, 815886, 3410505, 5145337, 7987800, 2124377, 5183998, 5082060, 4742723, 3074642, 7953248, 7094463, 7277837, 4452082, 4583311, 3738240, 7575010, 6057032, 374951, 2496004, 3887702, 7919340, 4088045, 5908989, 4962817, 2427710, 4931505, 3322933, 6388949, 3966429, 2818941, 2734099, 8215964, 5570646, 769120, 4666753, 7898754, 3952911, 6156769, 285441, 6522625, 2177869, 7506900, 7784571, 1908653, 332874, 5305231, 7947725, 7823426, 168591, 4955017, 3274433, 5548711, 4452061, 407967, 5130560, 7562931, 7327303, 5746488, 8119552, 5472635, 4784935, 7932492, 454032, 2143940, 5452302, 4142954, 457268, 3150419, 8072119, 720722, 476767, 4889378, 4223300, 6198651, 8189481, 2894702, 8066679, 4224353, 7288556, 5237729, 5037301, 8233115, 1323693, 8171543, 6897522, 2448537, 7081300, 3157279, 7073044, 4026319, 7928226, 642322, 6559208, 190494, 5514068, 3644378, 5546993, 6887926, 1116437, 8043159, 338314, 1153340, 4328392, 2058495, 7459760, 2837528, 326314, 3170047, 2042027, 6078806, 3042257, 7551265, 987276, 4284267, 7170841, 6911327, 4774106, 290431, 1234152, 4220099, 3368571, 6128178, 4076601, 7324321, 6816133, 5430434, 5315668, 3845450, 6225608, 3398406, 5362736, 2443041, 6362966, 2888055, 7084835, 2094713, 5096328, 3297810, 888158, 5140808, 500603, 5575682, 4574566, 4145792, 6430065, 5945015, 4575922, 7394476, 2826879, 1223069, 3829071, 1777361, 5462724, 5271973, 1320158, 1204573, 3327482, 8194029, 5109907, 5398103, 1267257, 5473969, 3830427, 6986220, 7904390, 5332655, 3737833, 775053, 2839405, 3417454, 3373132, 305524, 1160638, 3282636, 2462383, 5050410, 6619500, 4945626, 1171142, 1979224, 809890, 6413332, 7233851, 4855026, 5835515, 1400157, 4667160, 4633305, 1970528, 6146867, 1952340, 1229586, 4010547, 6769323, 5942610, 5879116, 7244355, 6393823, 7945547, 4996965, 3167354, 2339794, 471908, 1690967, 4915437, 2687103, 7079287, 7953767, 6151525, 1292506, 1135517, 2246699, 7176255, 6258634, 7269476, 7066224, 7551195, 2556701, 459446, 2482432, 3686699, 1792226, 5692079, 2521994, 4302871, 4767061, 1325706, 1600644, 3489556, 159577, 456826, 1535099, 6869137, 6500772, 1250762, 8253804, 2190915, 2825359, 5624167, 5789815, 1384982, 6550595, 6904771, 7662488, 7367986, 406171, 1500222, 3477546, 6874929, 76719, 7948167, 2089037, 1153908, 3627118, 1841808, 7873001, 5368915, 2585818, 2780826, 4994580, 6214078, 7171632, 6773664, 6241097, 3991427, 200210, 4567637, 8318036, 345586, 7418037, 8267993, 3190779, 2544430, 7130109, 4296289, 3983219, 1402935, 8067790, 4108704, 6289421, 4430637, 8009340, 1631329, 7383307, 1748521, 1016086, 913101, 4676572, 8287716, 2960884, 137000, 5398894, 8059407, 2600386, 6722545, 5065261, 5880107, 5561365, 1318705, 6985765, 6340538, 2423427, 4803834, 7429373, 3686115, 2339278, 1334881, 5085005, 1123889, 1204287, 7070112, 6048652, 6122539, 6920201, 1682448, 5042866, 7464427, 4296225, 2003667, 64479, 7214988, 1114166, 3601159, 4164473, 2064455, 6357485, 936471, 2167149, 4706406, 4218374, 6521372, 4933087, 361211, 4569434, 7825265, 5739839, 74855, 861518, 6158913, 6603656, 7576844, 3088345, 2246080, 5296878, 5941644, 3559563, 7468522, 7046327, 7938055, 5316226, 1011326, 98416, 2460326, 1220102, 579728, 4099298, 8043782, 2695898, 390337, 4415594, 43185, 2199724, 5477152, 6449055, 1257674, 1061927, 2642775, 7862474, 1730507, 1061026, 1515132, 4810963, 8171341, 2386297, 6889861, 4089620, 8119927, 4544227, 8014656, 1205793, 1024022, 256852, 2120844, 8101442, 1558317, 2868962, 5762218, 7006888, 7147319, 4822348, 1556014, 3601184, 8165137, 3718955, 1291499, 523805, 738616, 7542783, 6945729, 4617399, 7553490, 3798532, 4002748, 1019926, 5739205, 775088, 4402245, 3408152, 8237228, 6272386, 6848979, 5915709, 6477821, 7595908, 704511, 3706138, 3762892, 4882442, 1459264, 432750, 7666377, 6184712, 7852813, 6780739, 3028286, 1584807, 6203244, 5777692, 6210202, 4030085, 6270213, 3556943, 1807289, 1308532, 7378744, 4377683, 8388148, 4884289, 1026249, 2508166, 4068464, 7961863, 552180, 4233387, 6193357, 8304009, 1255109, 182827, 2002037, 2560193, 2134780, 3017256, 2194791, 3190534, 170608, 7195223, 5425338, 5734707, 489340, 6717711, 2610921, 7596703, 7968938, 4695563, 1837824, 1275616, 8029437, 7736376, 1552256, 2672259, 375556, 5655169, 53285, 2952259, 8234385, 5869587, 4163177, 8218140, 2008432, 1151372, 5049782, 6904101, 436055, 6347835, 5794072, 2490863, 7251227, 4875941, 712751, 1845114, 6395159, 1176741, 3722818, 2030009, 5499146, 8247009, 43705, 923239, 5602465, 7561898, 455315, 874428, 2802528, 1020684, 3489312, 2734127, 1153766, 5899177, 4178133, 7754677, 7294932, 4975695, 6315216, 6792039, 2905847, 5471251, 4682175, 1968406, 1707967, 7329055, 8044247, 8108525, 4647167, 5449879, 4288762, 7564399, 3062647, 2234481, 6062626, 7456006, 7173753, 1910632, 3249057, 4760469, 1231240, 595299, 7709814, 1721544, 6697026, 1957313, 7537819, 4020, 7770593, 3734452, 6813007, 8403952, 5342346, 2928390, 4116231, 122290, 2973376, 1118784, 7032873, 6679782, 4244195, 7314433, 753361, 1487418, 3192952, 6205316, 854167, 5147067, 7889000, 7290967, 2254012, 2645777, 515993, 3567907, 7437147, 8240463, 5431617, 1615887, 3007373, 7445307, 3827543, 7950325, 6516880, 286150, 5212041, 6348454, 7651632, 1682318, 7814418, 2434996, 7272087, 4594806, 7356075, 577673, 5266195, 3887307, 8069514, 198719, 8360147, 1458408, 927381, 5597631, 7201097, 316758, 7477612, 3947129, 7020596, 7833721, 590575, 3918781, 4062299, 2134627, 7769572, 6137798, 8199468, 5801151, 335479, 3998155, 3138798, 6080344, 6085359, 4020654, 5330058, 6303576, 7915425, 2278413, 693033, 3929613, 1487097, 4324123, 3146260, 1535266, 5959433, 1065441, 4378748, 2986542, 2445560, 654376, 997529, 2350266, 2319634, 1502833, 5071781, 2051694, 826626, 82329, 2884498, 4775139, 6917896, 3496258, 7711960, 688220, 2387596, 4402060, 4550163, 1954392, 7709678, 4816015, 6844641, 2685500, 1583099, 6698800, 7499523, 308157, 4687868, 4840800, 6073363, 4724656, 3717125, 6030946, 887784, 1059673, 6017397, 4245121, 4513011, 6448849, 1482126, 8143183, 833038, 3542387, 6821894, 3877418, 1560352, 2966254, 5719616, 7967488, 8077987, 3409280, 2756715, 4928233, 4729155, 1731939, 4555215, 4616282, 5500491, 4575684, 5782587, 1037511, 5942850, 1356060, 2622406, 7016262, 7311930, 1906899, 2685377, 6894862, 2267012, 7245500, 2815114, 6300791, 5455581, 1385379, 3849778, 2084479, 3675838, 1982341, 6053228, 7227670, 1643945, 233076, 7195237, 7149337, 3007404, 1630666, 4263175, 3435061, 4948878, 6565165, 2368989, 2675293, 790345, 6236896, 6036004, 3958285, 3053419, 3427919, 2351765, 3206900, 3797749, 4080321, 2597113, 3173353, 4012934, 1195165, 4141818, 1693494, 5397589, 6392363, 1261986, 4184278, 1768178, 7483526, 1687276, 7669702, 2708046, 965528, 7764035, 6826739, 27987, 4968594, 7601153, 1845714, 7923061, 1004253, 803840, 7341160, 1046318, 1289222, 7143007, 561790, 2226114, 6124052, 1289973, 2490308, 964338, 220591, 640958, 6623753, 5696947, 4307141, 2795100, 7729595, 6677606, 2516353, 7641739, 7060028, 5326383, 37923, 5186657, 1207855, 5700774, 1978525, 8095411, 4221177, 1629460, 5480542, 309582, 5417020, 4423403, 5969652, 5609893, 4189694, 6955843, 4815956, 90881, 4579567, 6368024, 5928489, 3218336, 1918808, 3078610, 4831078, 5967779, 3682426, 593495, 5661133, 7655428, 7301990, 3087154, 4883958, 5120096, 2836279, 1960853, 2887591, 2295982, 1761601, 4128440, 3581890, 6109011, 7405893, 4370531, 3776738, 2437214, 8103639, 7215594, 5987846, 7928632, 1708002, 2889477, 3053345, 3284897, 433795, 5317839, 6713958, 3876720, 5164872, 4515800, 1661017, 7235603, 2338364, 2776396, 197274, 5894153, 3043161, 6546235, 6258932, 4608563, 7068951, 745421, 8200884, 3796430, 8379093, 4724763, 6883480, 4528273, 1525979, 3521817, 6838166, 2017962, 7454905, 719370, 1076883, 2510840, 6533880, 5628597, 8265246, 5131280, 7603213, 1681972, 2965391, 7517826, 7205603, 2837987, 926563, 6266243, 1573250, 365669, 2124750, 8128402, 7100721, 239145, 4698559, 276591, 3841362, 5379076, 2803881, 3273713, 3283020, 3077132, 56522, 5496949, 1307768, 1405381, 7123335, 2138750, 5187630, 5567006};
#endif

void ntt(int32_t * Out, int32_t * A){

	if(Out!=A){
		memcpy(Out,A,sizeof(int32_t)*N);
	}

#if NIMS_TRI_NTT_MODE == 1
	asm_ntt_1(Out, merging_zetas);
	asm_ntt_1_radix3(Out, merging_zetas_radix3);
#endif

#if NIMS_TRI_NTT_MODE == 3
	asm_ntt_3(Out, merging_zetas);
#endif

#if NIMS_TRI_NTT_MODE == 5
	asm_ntt_5(Out, merging_zetas); //3-3-3-2
#endif

#if NIMS_TRI_NTT_MODE == 55
	asm_ntt_55(Out, merging_zetas);
	asm_ntt_55_radix3(Out, merging_zetas_radix3);

#endif

}
void invntt_tomont(int32_t * Out, int32_t * A){

	if(Out!=A){
		memcpy(Out,A,sizeof(int32_t)*N);
	}


#if NIMS_TRI_NTT_MODE == 1
	asm_intt_1_radix3(Out, merging_zetas_inv_radix3);
	asm_intt_1(Out, merging_zetas_inv);
#endif
#if NIMS_TRI_NTT_MODE == 3
	asm_intt_3(Out, merging_zetas_inv);
#endif
#if NIMS_TRI_NTT_MODE == 5
	asm_ntt_5(Out, merging_zetas_inv); //3-3-3-2
#endif
#if NIMS_TRI_NTT_MODE == 55
	asm_intt_55_radix3(Out, merging_zetas_inv_radix3);
	asm_intt_55(Out, merging_zetas_inv);
#endif
}



void pointwise_mul(int32_t* C, int32_t* A, int32_t* B){
	for(int i=0;i<N;i++){
		C[i] = montgomery_reduce((int64_t)A[i] * B[i]);
	}
}

void base_mul(int32_t* C, int32_t* A, int32_t* B, int32_t zeta){ //2차식 곱셈
	C[0]=montgomery_reduce((int64_t)A[2]*B[1]);
	C[0]+=montgomery_reduce((int64_t)A[1]*B[2]);
	C[0]=montgomery_reduce((int64_t)C[0]*zeta);
	C[0]+=montgomery_reduce((int64_t)A[0]*B[0]);

	C[1]  = montgomery_reduce((int64_t)A[2]* B[2]);
	C[1]  = montgomery_reduce((int64_t)C[1]* zeta);
	C[1] += montgomery_reduce((int64_t)A[0]* B[1]);
	C[1] += montgomery_reduce((int64_t)A[1]* B[0]);

	C[2]  = montgomery_reduce((int64_t)A[2]* B[0]);
	C[2] += montgomery_reduce((int64_t)A[1]* B[1]);
	C[2] += montgomery_reduce((int64_t)A[0]* B[2]);
}



void poly_base_mul(poly* c, poly* a, poly* b){
	#if NIMS_TRI_NTT_MODE==1
	asm_pointwise_montgomery_1(c->coeffs, a->coeffs, b->coeffs);

	#elif NIMS_TRI_NTT_MODE==3 //2차식 곱셈(poly)
	asm_pointwise_montgomery_3(c->coeffs, a->coeffs, b->coeffs, zetas+255);

	#elif NIMS_TRI_NTT_MODE==5
	asm_pointwise_montgomery_5(c, a, b);
	
	#elif NIMS_TRI_NTT_MODE==55//pointwise 곱셈
	asm_pointwise_montgomery_55(c->coeffs, a->coeffs, b->coeffs);
	#endif

}



void reduce_modQ(int32_t * a){
  for(int i=0;i<N;i++){ 
	a[i]=a[i] % Q;
  }
}


void poly_mul_schoolbook(poly* res, poly* a, poly* b)
{
	// Polynomial multiplication using the schoolbook method, c[x] = a[x]*b[x] 
	// SECURITY NOTE: TO BE USED FOR TESTING ONLY.  
	uint32_t i, j;

	int32_t c[N << 1];
	int32_t t0;
	for (i = 0; i < (N << 1); i++) c[i] = 0;

	for (i = 0; i < N; i++)
	{
		for (j = 0; j < N; j++)
		{
			t0 = ((int64_t)(Q+a->coeffs[i]) * (Q+b->coeffs[j])) % Q;
			c[i + j] = (c[i + j] + t0) % Q;
		}
	}

	for (i = N + (N >> 1) - 1; i < 2 * N - 1; i++) {
		c[i - (N>>1)] = (c[i - (N>>1)] + c[i]) % Q;
		c[i - N] = (Q + c[i - N] - c[i]) % Q;
	}


	for (i = N; i < N + (N >> 1) - 1; i++)
	{
		c[i - (N>>1)] = (c[i - (N>>1)] + c[i]) % Q;
		c[i - N] = (Q + c[i - N] - c[i]) % Q;
	}

	for (i = 0; i < N; i++)
		res->coeffs[i] = c[i];	
}

void poly_caddq(poly *a) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		a->coeffs[i] = caddq(a->coeffs[i]);

	DBENCH_STOP(*tred);
}

void poly_add(poly *c, const poly *a, const poly *b) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		c->coeffs[i] = a->coeffs[i] + b->coeffs[i];

	DBENCH_STOP(*tadd);
}

void poly_modadd(poly *c, poly *a, poly *b) {
	unsigned int i;

	for (i = 0; i < N; ++i)
		c->coeffs[i] = mod_add(a->coeffs[i], b->coeffs[i]);

}

void poly_sub(poly *c, poly *a, poly *b) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		c->coeffs[i] = a->coeffs[i] - b->coeffs[i];

	DBENCH_STOP(*tadd);
}

void poly_modsub(poly *c, poly *a, poly *b) {
	unsigned int i;
	for (i = 0; i < N; ++i)
		c->coeffs[i] = mod_sub(a->coeffs[i], b->coeffs[i]);
}

void poly_shiftl(poly *a) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		a->coeffs[i] <<= D;

	DBENCH_STOP(*tmul);
}

void poly_power2round(poly *a1, poly *a0, const poly *a) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		a1->coeffs[i] = power2round(&a0->coeffs[i], a->coeffs[i]);

	DBENCH_STOP(*tround);
}

void poly_decompose(poly *a1, poly *a0, const poly *a) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		a1->coeffs[i] = decompose(&a0->coeffs[i], a->coeffs[i]);

	DBENCH_STOP(*tround);
}

unsigned int poly_make_hint(poly *h, const poly *a0, const poly *a1) {
	unsigned int i, s = 0;
	DBENCH_START();

	for (i = 0; i < N; ++i) {
		h->coeffs[i] = make_hint(a0->coeffs[i], a1->coeffs[i]);
		s += h->coeffs[i];
	}

	DBENCH_STOP(*tround);
	return s;
}

void poly_use_hint(poly *b, const poly *a, const poly *h) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		b->coeffs[i] = use_hint(a->coeffs[i], h->coeffs[i]);

	DBENCH_STOP(*tround);
}

int poly_chknorm(poly *a, int32_t B) {
	unsigned int i;
	int32_t t;
	DBENCH_START();

	if (B > (Q - 1) / 8)
		return 1;

	for (i = 0; i < N; ++i) {
		/* Absolute value */
		t = a->coeffs[i] >> 31;
		t = a->coeffs[i] - (t & 2 * a->coeffs[i]);

		if (t >= B) {
			DBENCH_STOP(*tsample);
			return 1;
		}
	}
	DBENCH_STOP(*tsample);
	return 0;
}

static unsigned int rej_uniform(int32_t *a,
	unsigned int len,
	const uint8_t *buf,
	unsigned int buflen)
{
	unsigned int ctr, pos;
	uint32_t t;
	DBENCH_START();

#if NIMS_TRI_NTT_MODE == 5
	ctr = pos = 0;
	while (ctr < len && pos + 3 <= buflen) {
		t = buf[pos++];
		t |= (uint32_t)buf[pos++] << 8;
		t |= (uint32_t)buf[pos++] << 16;
		t &= 0x7FFFFF;	// Q -> 23-bit
		if (t < Q && t != 0)
			a[ctr++] = t;
	}
#else

	ctr = pos = 0;
	while (ctr < len && pos + 3 <= buflen) {
		t = buf[pos++];
		t |= (uint32_t)buf[pos++] << 8;
		t |= (uint32_t)buf[pos++] << 16;
		t &= 0xFFFFFF;
		if (t < Q && t != 0)
			a[ctr++] = t;
	}

	DBENCH_STOP(*tsample);
#endif

	return ctr;
}

//#define POLY_UNIFORM_NBLOCKS ((768 + STREAM128_BLOCKBYTES - 1)/STREAM128_BLOCKBYTES)
#define POLY_UNIFORM_NBLOCKS ((N*3 + STREAM128_BLOCKBYTES - 1)/STREAM128_BLOCKBYTES)
void poly_uniform(poly *a,
	const uint8_t seed[SEEDBYTES],
	uint16_t nonce)
{
	unsigned int i, ctr, off;
	unsigned int buflen = POLY_UNIFORM_NBLOCKS * STREAM128_BLOCKBYTES;
	uint8_t buf[POLY_UNIFORM_NBLOCKS*STREAM128_BLOCKBYTES + 2];
	stream128_state state;



	stream128_init(&state, seed, nonce);
	stream128_squeezeblocks(buf, POLY_UNIFORM_NBLOCKS, &state);

	ctr = rej_uniform(a->coeffs, N, buf, buflen);

	while (ctr < N) {
		off = buflen % 3;
		for (i = 0; i < off; ++i)
			buf[i] = buf[buflen - off + i];

		stream128_squeezeblocks(buf + off, 1, &state);
		buflen = STREAM128_BLOCKBYTES + off;
		ctr += rej_uniform(a->coeffs + ctr, N - ctr, buf, buflen);
	}

}

static unsigned int rej_eta(int32_t *a,
	unsigned int len,
	const uint8_t *buf,
	unsigned int buflen)
{
	unsigned int ctr, pos;
	uint32_t t0, t1;
	uint32_t t2, t3;
	DBENCH_START();

	ctr = pos = 0;
	while (ctr < len && pos < buflen) {

#if ETA == 2
		t0 = buf[pos] & 0x0F;
		t1 = buf[pos++] >> 4;
		if (t0 < 15) {
			t0 = t0 - (13 * t0 >> 8) * 5;
			a[ctr++] = 2 - t0;
		}
		if (t1 < 15 && ctr < len) {
			t1 = t1 - (13 * t1 >> 8) * 5;
			a[ctr++] = 2 - t1;
		}
#elif ETA == 1
		t0 = buf[pos] & 0x03;
		t1 = (buf[pos] >> 2) & 0x03;
		t2 = (buf[pos] >> 4) & 0x03;
		t3 = buf[pos++] >> 6;
		if (t0 < 3) {
			a[ctr++] = 1 - t0;
		}
		if (t1 < 3 && ctr < len) {
			a[ctr++] = 1 - t1;
		}
		if (t2 < 3 && ctr < len) {
			a[ctr++] = 1 - t2;
		}
		if (t3 < 3 && ctr < len) {
			a[ctr++] = 1 - t3;
		}
#endif
	}

	DBENCH_STOP(*tsample);
	return ctr;
}

#define POLY_UNIFORM_ETA_NBLOCKS ((136 + STREAM256_BLOCKBYTES - 1)/STREAM256_BLOCKBYTES)
void poly_uniform_eta(poly *a,
	const uint8_t seed[CRHBYTES],
	uint16_t nonce)
{
	unsigned int ctr;
	unsigned int buflen = POLY_UNIFORM_ETA_NBLOCKS * STREAM256_BLOCKBYTES;
	uint8_t buf[POLY_UNIFORM_ETA_NBLOCKS*STREAM256_BLOCKBYTES];
	stream256_state state;

	stream256_init(&state, seed, nonce);
	stream256_squeezeblocks(buf, POLY_UNIFORM_ETA_NBLOCKS, &state);

	ctr = rej_eta(a->coeffs, N, buf, buflen);

	while (ctr < N) {
		stream256_squeezeblocks(buf, 1, &state);
		ctr += rej_eta(a->coeffs + ctr, N - ctr, buf, STREAM256_BLOCKBYTES);
	}
}

#define POLY_UNIFORM_GAMMA1_NBLOCKS ((POLYZ_PACKEDBYTES + STREAM256_BLOCKBYTES - 1)/STREAM256_BLOCKBYTES)

void poly_uniform_gamma1(poly *a,
	const uint8_t seed[CRHBYTES],
	uint16_t nonce)
{
	uint8_t buf[POLY_UNIFORM_GAMMA1_NBLOCKS*STREAM256_BLOCKBYTES];
	stream256_state state;

	stream256_init(&state, seed, nonce);
	stream256_squeezeblocks(buf, POLY_UNIFORM_GAMMA1_NBLOCKS, &state);
	polyz_unpack(a, buf);
}
//sample in ball
void poly_challenge(poly *c, const uint8_t seed[SEEDBYTES]) {
	unsigned int i, b, pos;
	uint32_t signs;
	uint8_t buf[SHAKE256_RATE];
	shake256incctx state;

	shake256_inc_init(&state);
	shake256_inc_absorb(&state, seed, SEEDBYTES);
	shake256_inc_finalize(&state);
	shake256_inc_squeezeblocks(buf, 1, &state);

	signs = 0;
	for (i = 0; i < 4; ++i)
		signs |= (uint32_t)buf[i] << 8 * i;
	pos = 4;

	for (i = 0; i < N; ++i)
		c->coeffs[i] = 0;
#if (N==2304)
	for (i = N - TAU; i < N; ++i) {
		do {
			if (pos >= SHAKE256_RATE) {
				shake256_inc_squeezeblocks(buf, 1, &state);
				pos = 0;
			}

			b = (uint32_t)buf[pos++] << 4;
			b |= (buf[pos++] & 0xF);
		} while (b > i);

		c->coeffs[i] = c->coeffs[b];
		c->coeffs[b] = 1 - 2 * (signs & 1);
		signs >>= 1;
	}
#else
	for (i = N - TAU; i < N; ++i) {
		do {
			if (pos >= SHAKE256_RATE) {
				shake256_inc_squeezeblocks(buf, 1, &state);
				pos = 0;
			}

			b = (uint32_t)buf[pos++] << 3;
			b |= (buf[pos++] & 0x7);
		} while (b > i);

		c->coeffs[i] = c->coeffs[b];
		c->coeffs[b] = 1 - 2 * (signs & 1);
		signs >>= 1;
	}
#endif
}
/*************************************************
* Name:        poly_reduce
*
* Description: Inplace reduction of all coefficients of polynomial to
*              representative in [-6283009,6283007](딜리시움).
*
* Arguments:   - poly *a: pointer to input/output polynomial
**************************************************/
void poly_reduce(poly *a) {
  unsigned int i;
  DBENCH_START();

  for(i = 0; i < N; ++i)
    a->coeffs[i] = reduce32(a->coeffs[i]);
  //asm_reduce32(a->coeffs);

  DBENCH_STOP(*tred);
}
